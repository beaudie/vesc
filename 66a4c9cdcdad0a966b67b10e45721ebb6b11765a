{
  "comments": [
    {
      "key": {
        "uuid": "e7234448_b1425515",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-10T01:17:59Z",
      "side": 1,
      "message": "Looking good! I wonder if you want to add a VulkanPerformanceCountersTest so we don\u0027t accidentally regress this?",
      "revId": "66a4c9cdcdad0a966b67b10e45721ebb6b11765a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cafd83cb_3123fa57",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 9
      },
      "lineNbr": 982,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-09T23:16:03Z",
      "side": 1,
      "message": "Can we skip this work (and the hasGPUPendingCommands() check) and just always defer the flush if the render pass is open?",
      "revId": "66a4c9cdcdad0a966b67b10e45721ebb6b11765a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d5e6eea8_e9b50520",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 9
      },
      "lineNbr": 982,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-09-09T23:30:17Z",
      "side": 1,
      "message": "We can. For Manhattan this probably no difference. But IMO this check is worth while. If GPU is idle, and app is asking us to submit, why we hold off from submission, right?",
      "parentUuid": "cafd83cb_3123fa57",
      "revId": "66a4c9cdcdad0a966b67b10e45721ebb6b11765a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "44a7a837_73e5e474",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 9
      },
      "lineNbr": 982,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-09T23:53:32Z",
      "side": 1,
      "message": "True, assuming we do end up flushing sometimes.   Otherwise, it\u0027s lot of CPU cycles that don\u0027t result in any benefit if we really are GPU bound (which I think we expect on mobile).   I\u0027d prefer to start simple and add the complexity later when it\u0027s necessary.\n\nMaybe add a comment/todo so it doesn\u0027t get lost?",
      "parentUuid": "d5e6eea8_e9b50520",
      "revId": "66a4c9cdcdad0a966b67b10e45721ebb6b11765a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "688db3e0_b5f84039",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 9
      },
      "lineNbr": 982,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-09-10T00:23:32Z",
      "side": 1,
      "message": "checkCompletedCommands() itself still have a little benefit though:\n1) It allows command buffers gets recycled earlier and resource serials gets updated sooner, so not really wasted.\n2) For very first glFlush call, GPU is idle, this gets to GPU faster. This means new behavior is closer to old behavior than removing the check.\n\nThis call is not expected to be frequent call and is not in perf critical path as well, so IMO, this is better than not checking. Let me know if you feel strongly on this.",
      "parentUuid": "44a7a837_73e5e474",
      "revId": "66a4c9cdcdad0a966b67b10e45721ebb6b11765a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e37b2ad_f5874a40",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 9
      },
      "lineNbr": 982,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-10T01:17:59Z",
      "side": 1,
      "message": "I don\u0027t particularly mind the checkCompletedCommands() call, but I was also wondering if we should just drop hasGPUPendingCommands(). Is it really better to break the render pass instead of just waiting for it to naturally end?\n\nYou could potentially split the change, adding the hasGPUPendingCommands() check in a second CL and then measure the impact with or without it. If data shows no difference, we can drop it and keep it simpler. If there\u0027s an improvement, then great!",
      "parentUuid": "688db3e0_b5f84039",
      "revId": "66a4c9cdcdad0a966b67b10e45721ebb6b11765a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}