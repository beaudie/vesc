{
  "comments": [
    {
      "key": {
        "uuid": "ee734279_cf9c608c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-28T17:33:54Z",
      "side": 1,
      "message": "I need to open a bug for this change, but I wanted some feedback before doing that.",
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "72835c66_cccd2344",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-28T18:31:23Z",
      "side": 1,
      "message": "Could you provide some context? Is this a perf improvement for something in particular?",
      "parentUuid": "ee734279_cf9c608c",
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "96e504ca_3c0e1e02",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-28T19:06:38Z",
      "side": 1,
      "message": "I noticed in one of Charlie\u0027s CLs that we are disabling the D/S read-only mode if there are any deferred clears, rather than checking if we are clearing D/S specifically.   Presumably this means that we are disabling D/S read-only mode even if we are only clearing color attachments, which could be too aggressive.\n\nI wanted to get some feedback in case there are some other subtleties I\u0027m missing before opening a bug.",
      "parentUuid": "72835c66_cccd2344",
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc5badae_41fc9aa6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-29T02:30:22Z",
      "side": 1,
      "message": "This is begging for a regression test. Perhaps one in perf counter tests.",
      "parentUuid": "96e504ca_3c0e1e02",
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "14cb892b_141c8a78",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-29T15:15:37Z",
      "side": 1,
      "message": "We have VulkanPerformanceCounterTest::ReadOnlyDepthBufferLayout().   Is that what you\u0027re looking for?\n\nBased on Charlie\u0027s explanation, setting this flag here is redundant since we set the value in FramebufferVk::startNewRenderPass(), so updating it when we change framebuffers also isn\u0027t necessary.\n\nThis is all of the ways we get to FramebufferVk::setReadOnlyDepthMode():\n\n    FramebufferVk::setReadOnlyDepthMode\n        FramebufferVk::startNewRenderPass\n            ContextVk::startRenderPass\n            UtilsVk::blitResolveImpl\n        FramebufferVk::updateRenderPassReadOnlyDepthMode\n            ContextVk::updateActiveTextures\n            ContextVk::updateRenderPassDepthStencilAccess\n            FramebufferVk::clearWithCommand\n            FramebufferVk::clearWithLoadOp\n            UtilsVk::clearFramebuffer\n\nWhile it\u0027s (relatively) straightforward to know when we aren\u0027t updating the read/write state correctly, I\u0027m not sure how we could write a test to detect redundant updates to mReadOnlyDepthStencilMode.",
      "parentUuid": "cc5badae_41fc9aa6",
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "971128a1_41f1b46a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-28T17:33:19Z",
      "side": 1,
      "message": "PTAL",
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f659a71c_8f9e6292",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1736,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-09-28T18:20:54Z",
      "side": 1,
      "message": "Thanks Tim for follow up. I remember you mentioned this in my CL review, but I may slipped this one somehow.\n\nI am wondering if this whole four lines code should be deleted. The read/write mode is updated at the renderpass start time. If there is a deferred clear, the renderpass start time should pick up and disqualify it for readOnly layout.",
      "range": {
        "startLine": 1732,
        "startChar": 4,
        "endLine": 1736,
        "endChar": 5
      },
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cea8301a_328f2d88",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1736,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-28T19:06:38Z",
      "side": 1,
      "message": "I updated this CL to see how CQ responds to removing this and the priorReadOnlyDepthStencilMode checking below.",
      "parentUuid": "f659a71c_8f9e6292",
      "range": {
        "startLine": 1732,
        "startChar": 4,
        "endLine": 1736,
        "endChar": 5
      },
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b984cb2_1a2fa1ec",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1736,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-09-29T00:28:32Z",
      "side": 1,
      "message": "I guess the bot failure has nothing to do with your CL, right?",
      "parentUuid": "cea8301a_328f2d88",
      "range": {
        "startLine": 1732,
        "startChar": 4,
        "endLine": 1736,
        "endChar": 5
      },
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5b03993b_c00380cd",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1736,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-29T00:34:07Z",
      "side": 1,
      "message": "[ RUN      ] ClientStateEnable.Negative/ES1_Vulkan\n../../third_party/angle/src/tests/test_utils/ANGLETest.cpp:63: Failure\nRendererVk.cpp:336 (DebugUtilsMessenger): [ Loader Message ] terminator_CreateDevice: Failed in ICD libGLX_nvidia.so.0 vkCreateDevicecall\n                            Object: 0x1f8746c7b000 (type \u003d Instance(1))\n\nRetrying the run, since I\u0027ve never seen that error before.",
      "parentUuid": "3b984cb2_1a2fa1ec",
      "range": {
        "startLine": 1732,
        "startChar": 4,
        "endLine": 1736,
        "endChar": 5
      },
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7697e8e4_0c329b51",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1736,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-29T00:34:08Z",
      "side": 1,
      "message": "Almost certainly. Never seen that particular failure before.",
      "parentUuid": "3b984cb2_1a2fa1ec",
      "range": {
        "startLine": 1732,
        "startChar": 4,
        "endLine": 1736,
        "endChar": 5
      },
      "revId": "3ec9142cabd2ffe651f4aa894985ff20d46453fe",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}