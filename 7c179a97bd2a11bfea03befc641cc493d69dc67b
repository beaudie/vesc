{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "75c28832_f91ac9f6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1115588
      },
      "writtenOn": "2021-11-01T23:49:52Z",
      "side": 1,
      "message": "Here\u0027s one that\u0027s Mac only. not sure I did it correctly.\n\nJust FYI thought, iOS is/was already set to use D32_FLOAT???!?\n\nhttps://chromium.googlesource.com/angle/angle/+/refs/heads/main/src/libANGLE/renderer/metal/mtl_format_map.json#225",
      "revId": "7c179a97bd2a11bfea03befc641cc493d69dc67b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f2a47ab5_320424dd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2021-11-02T00:29:31Z",
      "side": 1,
      "message": "\u003e Here\u0027s one that\u0027s Mac only. not sure I did it correctly.\n\u003e \n\u003e Just FYI thought, iOS is/was already set to use D32_FLOAT???!?\n\u003e \n\u003e https://chromium.googlesource.com/angle/angle/+/refs/heads/main/src/libANGLE/renderer/metal/mtl_format_map.json#225\n\nHuh! Well, either this or your original formulation look fine then ðŸ˜Š",
      "parentUuid": "75c28832_f91ac9f6",
      "revId": "7c179a97bd2a11bfea03befc641cc493d69dc67b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "53c6780f_21c22db5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2021-11-02T00:29:31Z",
      "side": 1,
      "message": "Still lgtm\n",
      "revId": "7c179a97bd2a11bfea03befc641cc493d69dc67b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a474b1ff_2c781a9c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2021-11-02T20:03:54Z",
      "side": 1,
      "message": "Quyen, thanks for pointing out the difference in the JSON table between WebKit and ANGLE.\n\nGregg, it\u0027s probably OK to remove the iOS entry in this case, since Apple will be the main customer of the iOS backend. (Other apps could bundle ANGLE and might want to support \u003c\u003d iOS 13.0, but let\u0027s not worry about that for now)\n\nRegardless - let\u0027s try to get a second review of this today and land it. We can do follow-ups in subsequent patches.\n\nP.S. From Quyen\u0027s pointer, here\u0027s an interesting mention of differences in the application of the depth bias between unorm and float depth textures:\n\nhttps://developer.apple.com/documentation/metal/mtlrendercommandencoder/1516269-setdepthbias?language\u003dobjc\n\nIs it possible these differ enough from OpenGL\u0027s rules that it\u0027s not possible to build a conformant OpenGL implementation on top of Metal?\n",
      "revId": "7c179a97bd2a11bfea03befc641cc493d69dc67b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3f173c78_cd9bef49",
        "filename": "src/image_util/loadimage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 1764,
      "author": {
        "id": 1374244
      },
      "writtenOn": "2021-11-02T10:23:09Z",
      "side": 1,
      "message": "nit: FYI, previously these functions are not needed because `mtl::FormatTable::intialize()` would ignore the load functions for depth stencil formats (ignored because D16-D32F load function didn\u0027t exist and would crash):\nhttps://chromium.googlesource.com/angle/angle/+/b7cfbac4f8c5f77a1e45064ea9decb6bf654544c/src/libANGLE/renderer/metal/mtl_format_utils.mm#196\n\nThe tex data uploading process at that point would use a custom function in TextureMtl.mm instead which supports D16-\u003eD32F: https://chromium.googlesource.com/angle/angle/+/refs/heads/main/src/libANGLE/renderer/metal/TextureMtl.mm#202\n\nHowever, the Webkit upstream patch removed the skipping of depth stencil formats\u0027 load functions: https://chromium.googlesource.com/angle/angle/+/refs/heads/main/src/libANGLE/renderer/metal/mtl_format_utils.mm#263\nBut iOS\u0027s \"D16_UNORM\": \"D32_FLOAT\" overriding entry was still kept in the json file. This is a divergent point between Webkit and ANGLE, on Webkit repo, this entry was removed: https://github.com/WebKit/WebKit/blob/main/Source/ThirdParty/ANGLE/src/libANGLE/renderer/metal/mtl_format_map.json#L211\n\nThis most likely happened due to mistake in the merging process.",
      "range": {
        "startLine": 1724,
        "startChar": 5,
        "endLine": 1764,
        "endChar": 46
      },
      "revId": "7c179a97bd2a11bfea03befc641cc493d69dc67b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a13448e1_4ea0171a",
        "filename": "src/image_util/loadimage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 1764,
      "author": {
        "id": 1115588
      },
      "writtenOn": "2021-11-02T18:10:28Z",
      "side": 1,
      "message": "I\u0027m not sure what you\u0027re suggesting I do.",
      "parentUuid": "3f173c78_cd9bef49",
      "range": {
        "startLine": 1724,
        "startChar": 5,
        "endLine": 1764,
        "endChar": 46
      },
      "revId": "7c179a97bd2a11bfea03befc641cc493d69dc67b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c59ab541_bb8cb61e",
        "filename": "src/image_util/loadimage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 1764,
      "author": {
        "id": 1374244
      },
      "writtenOn": "2021-11-02T19:31:23Z",
      "side": 1,
      "message": "Actually that was not a suggestion. I just wanted to point out that the format table\u0027s code is currently having some inconsistencies between Webkit \u0026 ANGLE after an upstream patch.\nThe long explanation was just for everyone to better understand the situation.\nSorry if that didn\u0027t help.",
      "parentUuid": "a13448e1_4ea0171a",
      "range": {
        "startLine": 1724,
        "startChar": 5,
        "endLine": 1764,
        "endChar": 46
      },
      "revId": "7c179a97bd2a11bfea03befc641cc493d69dc67b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}