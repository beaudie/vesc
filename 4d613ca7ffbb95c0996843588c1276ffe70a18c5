{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e5ea9b6e_a4d518ff",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1691,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-09-20T20:46:53Z",
      "side": 0,
      "message": "You can avoid the double-query by leaving the above as-is, then remove this assert and do this instead:\n\n```\n// \u003cmention of the bug\u003e\nif (mCompatiblePresentModes.empty())\n{\n    mCompatiblePresentModes.push_back(mDesiredSwapchainPresentMode);\n}\n```\n\nEverything else can be left untouched if I\u0027m not mistaken.",
      "revId": "4d613ca7ffbb95c0996843588c1276ffe70a18c5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bbca0d51_ffec7af5",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1691,
      "author": {
        "id": 1531247
      },
      "writtenOn": "2024-09-20T20:54:21Z",
      "side": 0,
      "message": "I don\u0027t think this works? mCompatiblePresentModes is fixedvector\u003ckMaxCompatiblePresentModes\u003e and we have no way to get the correct size. Note that `vkGetPhysicalDeviceSurfaceCapabilities2KHR` doesn\u0027t return 0 - it has no effect at all.\n\nI did mess up my initial implementation though. Updated. Happy to simplify if there is a way.",
      "parentUuid": "e5ea9b6e_a4d518ff",
      "revId": "4d613ca7ffbb95c0996843588c1276ffe70a18c5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4cb1e506_8cd73631",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1691,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-09-20T21:00:38Z",
      "side": 0,
      "message": "Oh right, you can change `kMaxCompatiblePresentModes` to something definitely too big, like 10, then check if `presentModeCount` stays `kMaxCompatiblePresentModes`.\n\nOnce we know the struct didn\u0027t have any effect, all we need to do is resize it to 1 and push `mDesiredSwapchainPresentMode`; every present mode is compatible with itself, we can pretend that\u0027s what the driver returned and the rest of the code is supposed to handle that.",
      "parentUuid": "bbca0d51_ffec7af5",
      "revId": "4d613ca7ffbb95c0996843588c1276ffe70a18c5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2bd7f98f_68bf88a2",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1691,
      "author": {
        "id": 1531247
      },
      "writtenOn": "2024-09-23T13:47:05Z",
      "side": 0,
      "message": "I mean.. ewww.. but okay the code diff would be smaller, I\u0027ll do it this way if you prefer.",
      "parentUuid": "4cb1e506_8cd73631",
      "revId": "4d613ca7ffbb95c0996843588c1276ffe70a18c5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4c759873_37d1d57a",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1691,
      "author": {
        "id": 1531247
      },
      "writtenOn": "2024-09-23T14:09:42Z",
      "side": 0,
      "message": "Done",
      "parentUuid": "2bd7f98f_68bf88a2",
      "revId": "4d613ca7ffbb95c0996843588c1276ffe70a18c5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}