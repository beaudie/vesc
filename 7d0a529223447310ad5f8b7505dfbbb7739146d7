{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "cfc0a2db_a2e5cc8a",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 2190,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "With what I suggested, `colorRenderTarget-\u003egetImageForRenderPass().getActualFormatID())` should return `angle::FormatID::EXTERNAL0`, then you do not need this special case for YUV.",
      "range": {
        "startLine": 2180,
        "startChar": 12,
        "endLine": 2190,
        "endChar": 16
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5b3f6bdf_76c649ba",
        "filename": "src/libANGLE/renderer/vulkan/android/HardwareBufferImageSiblingVkAndroid.cpp",
        "patchSetId": 1
      },
      "lineNbr": 313,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "My suggestion is having RendererVk (or a global table, see `GetVkFormatFromFormatID()` implementtaion for reference) keep the mapping between `angle::FormatID::EXTERNAL{n}` and `mExternalResolveColorFormat` so that you can convert from FormatID to external format at any time. You will not need to save this to ImageHelper and RenderPassDesc. What you need here is change line 299 to something like this:\n```\nconst vk::Format \u0026externalVkFormat \u003d renderer-\u003egetExternalFormat(mExternalResolveColorFormat);\n```\n\n(Just for bring up, since you only have one external format, you can just store it in RendererVk. Once you get most stuff working, you can add ExternalFormat allocation and mapping.)",
      "range": {
        "startLine": 313,
        "startChar": 4,
        "endLine": 313,
        "endChar": 31
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05a591c2_3ab0ea55",
        "filename": "src/libANGLE/renderer/vulkan/android/HardwareBufferImageSiblingVkAndroid.cpp",
        "patchSetId": 1
      },
      "lineNbr": 376,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "In YUV case, isExternal will be true, so format is externalVkFormat. format.getIntendedFormatID() and getActualRenderableImageFormatID() should be `angle::FormatID::EXTERNAL0` here (which will be set to mImage bellow at line 386.",
      "range": {
        "startLine": 376,
        "startChar": 0,
        "endLine": 376,
        "endChar": 82
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3a259bb_f3121446",
        "filename": "src/libANGLE/renderer/vulkan/android/HardwareBufferImageSiblingVkAndroid.cpp",
        "patchSetId": 1
      },
      "lineNbr": 436,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "With what I suggested to keep the formatID and externalFormat mapping in RendererVk, then you do not need this.",
      "range": {
        "startLine": 436,
        "startChar": 16,
        "endLine": 436,
        "endChar": 47
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "20b22e73_d9c5a97d",
        "filename": "src/libANGLE/renderer/vulkan/vk_cache_utils.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6531,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "you dont need this.",
      "range": {
        "startLine": 6531,
        "startChar": 28,
        "endLine": 6531,
        "endChar": 42
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "23945828_fa96f75f",
        "filename": "src/libANGLE/renderer/vulkan/vk_cache_utils.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6654,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "Inside this function, you will do something like this:\n```\nif(isYUV)\n{\n    ASSERT(formatID \u003e\u003d EXTERNAL0);\n    VkExternalFormatANDROID externalFormat \u003d rendererVk-\u003egetExternalFormatForID(attachmentFormatID);\n    attachment.pNext  \u003d \u0026externalFormat;\n    attachment.format \u003d VK_FORMAT_UNDEFINED;\n}\nelse\n{\n    ASSERT(formatID \u003c EXTERNAL0);\n    desc-\u003eformat \u003d GetVkFormatFromFormatID(formatID);\n}\n\n```\n\nYou can pass isYUV and rendererVk to the function `UnpackColorResolveAttachmentDesc` if needed",
      "range": {
        "startLine": 6654,
        "startChar": 12,
        "endLine": 6654,
        "endChar": 44
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4fc36a16_a101f451",
        "filename": "src/libANGLE/renderer/vulkan/vk_cache_utils.cpp",
        "patchSetId": 1
      },
      "lineNbr": 6654,
      "author": {
        "id": 1298072
      },
      "writtenOn": "2023-09-12T23:02:59Z",
      "side": 1,
      "message": "there are lifetime issues here -- the VkExternalFormatANDROID must live until vkCreateRenderPass2 returns, which is why it\u0027s not local here.",
      "parentUuid": "23945828_fa96f75f",
      "range": {
        "startLine": 6654,
        "startChar": 12,
        "endLine": 6654,
        "endChar": 44
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46645174_da2b2edd",
        "filename": "src/libANGLE/renderer/vulkan/vk_cache_utils.h",
        "patchSetId": 1
      },
      "lineNbr": 236,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "You dont need this with what I suggest that stores the map of External{n} and actual external format in the rendererVk.",
      "range": {
        "startLine": 224,
        "startChar": 4,
        "endLine": 236,
        "endChar": 0
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cce5750a_d8f8ab09",
        "filename": "src/libANGLE/renderer/vulkan/vk_cache_utils.h",
        "patchSetId": 1
      },
      "lineNbr": 260,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "You can use one bit to indicate it is YUV rendering?\n```\nuint8_t mIsRenderToYUV : 1;\n```",
      "range": {
        "startLine": 260,
        "startChar": 12,
        "endLine": 260,
        "endChar": 21
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "010fe26b_13b0216e",
        "filename": "src/libANGLE/renderer/vulkan/vk_cache_utils.h",
        "patchSetId": 1
      },
      "lineNbr": 301,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-09-12T17:48:02Z",
      "side": 1,
      "message": "You dont need this with what I suggest that stores the map of External{n} and actual external format in the rendererVk.",
      "range": {
        "startLine": 299,
        "startChar": 0,
        "endLine": 301,
        "endChar": 0
      },
      "revId": "7d0a529223447310ad5f8b7505dfbbb7739146d7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}