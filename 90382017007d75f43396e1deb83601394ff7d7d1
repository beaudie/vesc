{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "9ff787ff_a395894d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-11T20:36:49Z",
      "side": 1,
      "message": "Found that I was checking instance extensions not device extensions. We now see it and enable feature.",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "809b29d5_b7f21e44",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-11T23:53:03Z",
      "side": 1,
      "message": "One question about barrierImpl() that seems wrong.",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "35245941_43cb670c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T00:20:19Z",
      "side": 1,
      "message": "Call for feedback. See below where layout is changed.",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e39ab8bb_e1a94316",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2021-11-12T00:40:15Z",
      "side": 1,
      "message": "Glad you found it!",
      "parentUuid": "9ff787ff_a395894d",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d9cb54a7_baf6742b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T00:41:36Z",
      "side": 1,
      "message": "Extension - yes. good.\nLayout Transition - don\u0027t know how to fix yet.",
      "parentUuid": "e39ab8bb_e1a94316",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e022ab6c_07a08104",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T15:26:32Z",
      "side": 1,
      "message": "Advice greatly desired. Help",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e25de2ed_930cdcfa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T15:39:18Z",
      "side": 1,
      "message": "onResourceAccess is called from ContextVk getOutsideRenderPassCommandBuffer(). So called from many places.",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "462463cf_f4bcd1bc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T15:43:02Z",
      "side": 1,
      "message": "Reference: https://www.khronos.org/registry/vulkan/specs/1.2-extensions/html/chap50.html#VK_KHR_shared_presentable_image\nIssue #6\n\n6) What should the layout of the shared presentable image be?\n\nRESOLVED: After acquiring the shared presentable image, the application must transition it to the VK_IMAGE_LAYOUT_SHARED_PRESENT_KHR layout prior to it being used. After this initial transition, any image usage that was requested during swapchain creation can be performed on the image without layout transitions being performed.\n",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "938427d0_8e03e704",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-11-12T15:54:57Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "462463cf_f4bcd1bc",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "51cfe341_6d6a64dc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T16:03:00Z",
      "side": 1,
      "message": "I think I tried that. We can do again once my helper is in office.\n\nI have this left from a log, if it helps:\nINFO: ContextVk.cpp:6276 (onResourceAccess): \nINFO: vk_helpers.h:1843 (recordWriteBarrier): recordWriteBarrier\nINFO: vk_helpers.cpp:4989 (barrierImpl): mCurrentLayout: SharedPresent\nINFO: vk_helpers.cpp:4990 (barrierImpl): newLayout: TransferDst\nINFO: vk_helpers.h:1868 (recordReadBarrier): recordReadBarrier\nINFO: vk_helpers.cpp:4989 (barrierImpl): mCurrentLayout: SharedPresent\nINFO: vk_helpers.cpp:4990 (barrierImpl): newLayout: Present\nWARN: Debug.cpp:180 (insertMessage): GL error: HIGH: Internal Vulkan error (2): A wait operation has not completed in the specified time.\nINFO: Debug.cpp:490 (insertMessage): EGL ERROR: eglSwapBuffers: Internal Vulkan error (0): Command successfully completed, in , :0.\nWARN: Debug.cpp:180 (insertMessage): GL error: HIGH: Internal Vulkan error (2): A wait operation has not completed in the specified time.\n",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d357632_2b538af4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T16:26:58Z",
      "side": 1,
      "message": "It may, remotely, also be the platform we are testing with. So I will get an upload ASAP.",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4169a198_9be0bcfd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-11-12T16:51:07Z",
      "side": 1,
      "message": "Does this work on any platform I may have access to? (Linux/Nvidia, Linux/Intel and Pixel 4) If so, I could spend some time debugging it too.",
      "parentUuid": "7d357632_2b538af4",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d3ade69c_1d0e330e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T17:04:15Z",
      "side": 1,
      "message": "The pixel4 seems to run it, only thing on CI that I noticed ran it, BUT that was when the extension was not detected correctly.. Brandon should be uploading the latest soon. Latest has 2 fixes, the extension detection, and setCurrentLayout in ImageHelper. You will want those.",
      "parentUuid": "4169a198_9be0bcfd",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "84123b1e_45ba1d13",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T17:04:15Z",
      "side": 1,
      "message": "Response",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0e9cb0f0_9c0c7586",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 11
      },
      "lineNbr": 6213,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T00:20:19Z",
      "side": 1,
      "message": "This is changing the layout to TransferDst after we are in SharedPresent.\nWhat should be done? Ignore?",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d44d8451_551c23bc",
        "filename": "src/libANGLE/renderer/vulkan/RendererVk.cpp",
        "patchSetId": 11
      },
      "lineNbr": 1225,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-11T23:53:03Z",
      "side": 1,
      "message": "This needs to be in device extensions section.",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cb48bf3e_8806464b",
        "filename": "src/libANGLE/renderer/vulkan/RendererVk.cpp",
        "patchSetId": 11
      },
      "lineNbr": 1232,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-11T23:53:03Z",
      "side": 1,
      "message": "Remove debug.",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "52762a39_2bd60ddd",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 11
      },
      "lineNbr": 1771,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-11T23:53:03Z",
      "side": 1,
      "message": "Need to save new Layout here.\nimage.image.setCurrentImageLayout(ImageLayout::SharedPresent);",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "68a69624_25d88527",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 11
      },
      "lineNbr": 1771,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-11-12T01:58:38Z",
      "side": 1,
      "message": "No, that would skip the transition to SharedPresent. The way the current code is, the transition to SharedPresent would happen as soon as the image transitions to anything.",
      "parentUuid": "52762a39_2bd60ddd",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3beb64b8_5a624086",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 11
      },
      "lineNbr": 4984,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-11T23:53:03Z",
      "side": 1,
      "message": "Is this right? \nWe are getting a call after we are in SharedPresent to go to TransferDst. Maybe from flush. Should the transition just be ignored?",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c654db7_2b4ba5b5",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 11
      },
      "lineNbr": 4984,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-11-12T01:58:38Z",
      "side": 1,
      "message": "We had this discussion in the past, see Ref. Your comment was:\n\n\u003e My interpretation is that it transitions once to SHARED_PRESENT and stays there.\n\nThat\u0027s why we made everything such that on first transition, we transition to SharedPresent, and then we make sure it stays SharedPresent forever.",
      "parentUuid": "3beb64b8_5a624086",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea94b0b3_cf3b0d16",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 11
      },
      "lineNbr": 4984,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T15:26:32Z",
      "side": 1,
      "message": "Yes, We are now getting a transition to TransferDst from ContextVk::onResourceAccess(), and I don\u0027t know what to do. \nTried ignoring if in SharedPresent, Also tried forcing to stay SharePresent - crash.\nWe have a Monday deadline. Any help to get this working would be greatly appreciated.",
      "parentUuid": "3c654db7_2b4ba5b5",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4f5c242c_2ec6c478",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 11
      },
      "lineNbr": 4984,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T15:39:18Z",
      "side": 1,
      "message": "onResourceAccess is called from ContextVk getOutsideRenderPassCommandBuffer().",
      "parentUuid": "ea94b0b3_cf3b0d16",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd2b6e89_4eec4af2",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 11
      },
      "lineNbr": 4984,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-11-12T15:54:57Z",
      "side": 1,
      "message": "Ok we missed this function. See what we did for ImageHelper::updateLayoutAndBarrier:\n\n    // Once you transition to ImageLayout::SharedPresent, you never transition out of it.\n    if (mCurrentLayout \u003d\u003d ImageLayout::SharedPresent)\n    {\n        newLayout \u003d ImageLayout::SharedPresent;\n    }\n\nCan you put that in ImageHelper::barrierImpl too? We shouldn\u0027t ignore the barrier, just keep the layout the same.\n\n---\n\nIf that still crashes, can you please detail what the crash is?",
      "parentUuid": "4f5c242c_2ec6c478",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "90297bb8_a256bb18",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 11
      },
      "lineNbr": 4984,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-12T16:03:00Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "fd2b6e89_4eec4af2",
      "revId": "90382017007d75f43396e1deb83601394ff7d7d1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}