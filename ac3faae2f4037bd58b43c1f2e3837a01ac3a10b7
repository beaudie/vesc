{
  "comments": [
    {
      "key": {
        "uuid": "1837db6e_963d8e75",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 880,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-02-15T05:15:27Z",
      "side": 1,
      "message": "Maybe in some benchmark this shows an improvement, but this could hit a finishToSerial if the buffer is in use by the GPU. That\u0027s definitely not better than closing a renderpass.\n\nIdeally, you want the condition to say:\n\n    if (host_visible \u0026\u0026 !in_use_by_gpu \u0026\u0026 renderpass_started)\n\nSo:\n\n- If not host visible, convert on GPU (only option)\n- If in use by the GPU, convert on GPU (to avoid finishToSerial, making CPU wait for GPU) and suffer the renderpass closing.\n- (this is an optimization) If no render pass is started, convert on GPU (faster than CPU)\n\n---\n\nAlso, I\u0027m fairly certain the benchmark is not filling the buffer inside the renderpass, so ideally this operation should be reordered and done before the renderpass starts (so this change is unnecessary altogether). Jamie, is the new graph capable of doing such a thing? Charlie, was this breaking the renderpass using the old command graph?",
      "range": {
        "startLine": 880,
        "startChar": 20,
        "endLine": 880,
        "endChar": 55
      },
      "revId": "ac3faae2f4037bd58b43c1f2e3837a01ac3a10b7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}