{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "a272473e_d9ff0fa4",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1256237
      },
      "writtenOn": "2021-04-28T03:15:00Z",
      "side": 1,
      "message": "Won\u0027t this swap be skipped in Onscreen and Vsync versions?",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eeb98b34_20d86cc2",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-04-28T14:58:29Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "a272473e_d9ff0fa4",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0a1b0cc4_5c1d5996",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-04-28T20:47:58Z",
      "side": 1,
      "message": "I was thinking when gMinimizeGPUWork is set, it should automatically enable offscreen as well. There is no value to have onscreen testing with gMinimizeGPUWork. I just don\u0027t know whats the best way to automatically force offscreen. Opinion?",
      "parentUuid": "eeb98b34_20d86cc2",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c4752e9e_3a561366",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-04-29T23:06:52Z",
      "side": 1,
      "message": "I have changed to glFlush call for gMinimizeGPUWork, regardless onscreen or offscreen.",
      "parentUuid": "0a1b0cc4_5c1d5996",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c39dc99_acc7848b",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-04-30T16:45:14Z",
      "side": 1,
      "message": "It would still be preferred to handle the case where someone sets minimize gpu work with on-screen.",
      "parentUuid": "c4752e9e_3a561366",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4292d3af_1b39503b",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-04-30T16:46:31Z",
      "side": 1,
      "message": "Sorry, on-screen is the wrong term. Rendering to a surface.",
      "parentUuid": "4c39dc99_acc7848b",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2c3390b3_5597812e",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-04-30T17:58:41Z",
      "side": 1,
      "message": "Right, we will issue glFlush when render to surface as well. The question here really are:\n\n1) Do we want to allow the combination of onscreen and gMinimizeGPUWork?\nMy understanding from what you just said above is that you prefer it to be a valid combination. I was originally thinking this will be invalid and we automatically ignore onscreen request and always test offscreen. But I am okay with onscreen+gMinimizeGPUWork to be a valid combination\n\n2) If on screen is valid, do we want to issue swap for each frame or a glFlush is enough?\nIf we do swap, you will see swap becomes dominant calls in the trace (we are still doing some kind of sync even with vsync off. ANd swap behavior is a bit different native versus angle). Since the focus here is CPU overhead, I think we should move swap behavior out of picture. So my preference is issue glFlush instead of swap.\n\nPatchSet 9 will issue glFlush, regardless onscreen or offscreen. If onscreen it will render to surface and issue a glFlush. If offscreen it will render to FBO and issue a glFlush.\n\nDoes this sounds right to you?",
      "parentUuid": "4292d3af_1b39503b",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a185a0d7_165ecdb8",
        "filename": "src/tests/perf_tests/TracePerfTest.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1205,
      "author": {
        "id": 1256237
      },
      "writtenOn": "2021-05-03T16:19:02Z",
      "side": 1,
      "message": "Minimizing the application\u0027s GPU work while still allowing the display system to run would provide value by isolating GPU work done by SurfaceFlinger.  I think we should go ahead and support it even though you focus on offscreen.  glFlush after each frame sounds good to me, along with a swap for onscreen and vsync modes, knowing that this triggers dominant work per frame.",
      "parentUuid": "2c3390b3_5597812e",
      "range": {
        "startLine": 1205,
        "startChar": 0,
        "endLine": 1205,
        "endChar": 15
      },
      "revId": "41bd0c6ea9f3b89d11160a7ba3a38306c2207036",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}