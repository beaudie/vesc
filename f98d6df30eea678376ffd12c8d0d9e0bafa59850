{
  "comments": [
    {
      "key": {
        "uuid": "02e77386_db805dc7",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 479,
      "author": {
        "id": 1340649
      },
      "writtenOn": "2020-05-01T01:25:38Z",
      "side": 1,
      "message": "shouldnt this be - if (!isCoherent()) { flush(); } ?",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26c3ac51_c98a1373",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 479,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-05-01T02:04:59Z",
      "side": 1,
      "message": "... (and recall that flush() should be called while the memory is mapped)",
      "parentUuid": "02e77386_db805dc7",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b6f319ed_66ec4227",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 4080,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-05-01T00:11:28Z",
      "side": 1,
      "message": "Is being coherent an error here?\nCertainly unnecessary to do a flush if coherent but what if that was the only memory given to us?\nProbably this is assured at allocation time but that\u0027s not obvious here.",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "053da485_565ff960",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 4080,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-05-01T00:16:42Z",
      "side": 1,
      "message": "Not an error. I add here because we are calling flush , we are expecting buffer is not coherent. If someday someone changed the memory allocation flag to make it coherent but did not remove flush call here, this assertion will catch it. Basically try to ensure implementation matches expectation with this ASSERT.",
      "parentUuid": "b6f319ed_66ec4227",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "afb8403d_e3b57216",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 4080,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-05-01T00:55:37Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "053da485_565ff960",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "64757ca1_025a6ebc",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.h",
        "patchSetId": 1
      },
      "lineNbr": 115,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-05-01T02:04:59Z",
      "side": 1,
      "message": "I would rather see `flush()` automatically test this, and skip if coherent (same way it tests for mHostVisible, there could be a cached flag like mHostVisibleNonCoherent). Then call flush liberally and don\u0027t worry about how the buffer was created.\n\nThat\u0027s similar to how BufferHelper::flush/invalidate do it. Then you won\u0027t need `isCoherent` or the assertions.",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0be475fa_2eb2567b",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.h",
        "patchSetId": 1
      },
      "lineNbr": 115,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-05-01T02:11:14Z",
      "side": 1,
      "message": "Then this will be a run time check. If we designed this to be a coherent memory, we should catch error with assert.\nNote that most places are doing properly as I checked. SO far I only able to find one place missing flush.",
      "parentUuid": "64757ca1_025a6ebc",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e0ff6a10_b0460cff",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.h",
        "patchSetId": 1
      },
      "lineNbr": 115,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-05-01T02:19:38Z",
      "side": 1,
      "message": "Yes, and that\u0027s fine. There\u0027s already a run-time check for `mHostVisible`, it might as well be `mHostVisibleNonCoherent`.\n\nI don\u0027t think it\u0027s done right now, but DynamicBuffer should really look at the actual memory properties to make this decision instead of the requested one. As it stands, DynamicBuffer asks for host visible memory, which it may or may not get a coherent one for it, so the decision is technically really a runtime one.",
      "parentUuid": "0be475fa_2eb2567b",
      "revId": "f98d6df30eea678376ffd12c8d0d9e0bafa59850",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}