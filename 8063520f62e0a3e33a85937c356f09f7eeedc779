{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "36972b57_54448425",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1340649
      },
      "writtenOn": "2022-06-15T22:32:32Z",
      "side": 1,
      "message": "PTAL",
      "revId": "8063520f62e0a3e33a85937c356f09f7eeedc779",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2475f6a5_529b6d6d",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1363,
      "author": {
        "id": 1509302
      },
      "writtenOn": "2022-06-15T23:25:30Z",
      "side": 1,
      "message": "Re-using the hack works practically, but I\u0027m not sure if ANGLE folks want a deeper fix to update `mDesiredSwapchainPresentMode` and recreate the swapchain accordingly based on what the app requests.\n\nThe reason it works practically is because of the comment above. Currently we have two call sequences:\n1. app requests autorefresh before angle recreates swapchain for shared present\n2. app toggles autorefresh after angle recreates the swapchain\n\nFor (1), `mAutoRefreshEnabled` makes angle to create with `VK_PRESENT_MODE_SHARED_CONTINUOUS_REFRESH_KHR`.\n\nFor (2), angle doesn\u0027t recreate the swapchain, but that\u0027s fine since the platform would still passthrough the app\u0027s request into the Surface to toggle it, and that behavior is still transparent to both angle and the Vulkan implementation.\n\nConsidering the cost/overhead of swapchain recreation, I\u0027m not a big fan for the deeper fix. Up to our angle folks ; )",
      "revId": "8063520f62e0a3e33a85937c356f09f7eeedc779",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "812fd6af_88d32491",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1363,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2022-06-16T02:13:26Z",
      "side": 1,
      "message": "This seems very fragile, what if another window system implements this? (Usually that ends up being Wayland ðŸ˜„)\n\nI\u0027m assuming this toggling doesn\u0027t actually happen often, so if we could recreate the swapchain with the right mode, we\u0027ll have a much cleaner state (instead of saying the mode is demand refresh, but there\u0027s this bool that says actually it\u0027s not).\n\nHow about letting the toggle cause a swapchain recreation, and in `GetDesiredPresentMode` we choose whether to use auto or demand refresh by querying the front-end? Then we also don\u0027t need to cache `mAutoRefreshEnabled` in the backend.\n\nWould that work?",
      "parentUuid": "2475f6a5_529b6d6d",
      "revId": "8063520f62e0a3e33a85937c356f09f7eeedc779",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}