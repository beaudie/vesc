{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "45fe99cb_94ad68d5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1115588
      },
      "writtenOn": "2022-08-30T15:51:40Z",
      "side": 1,
      "message": "I\u0027m not sure why this was \"WaitForScheduled\" vs just \"NoWait\".",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2e6f55f7_e388966d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2022-08-30T18:23:02Z",
      "side": 1,
      "message": "lgtm\n\nThe only reason I can think of why this wouldn\u0027t work is IOSurface interactions - if for some reason Chrome or WebKit are relying on the command buffer reaching the GPU before handing an IOSurface to Core Animation. I\u0027d hope that the tests would cover this, but it might show up as flickering and the tests might not catch regressions. Anyway, let\u0027s proceed with this and test thorougly with Canary.\n",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b8d7b5f1_2c7cb7fd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2022-08-30T18:24:40Z",
      "side": 1,
      "message": "Also +ynovikov@ - did the gpu.fyi tryjobs test this ANGLE CL properly? I\u0027m not 100% sure what the current status is of running Chromium trybots against ANGLE CLs.\n",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9338081f_acc194a8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2022-08-30T18:34:46Z",
      "side": 1,
      "message": "No, gpu_fyi_try_* bots can\u0027t test ANGLE CLs.\nWe have these trybots instead https://luci-milo.appspot.com/ui/p/chromium/g/tryserver.chromium.angle/builders\nhttps://luci-milo.appspot.com/p/chromium/builders/try/mac-angle-chromium-try should give a good coverage for this. Although, it doesn\u0027t run on M1.",
      "parentUuid": "b8d7b5f1_2c7cb7fd",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fb7aba24_db2a5877",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2022-08-30T18:37:19Z",
      "side": 1,
      "message": "Thanks, sent to mac-angle-chromium-try.",
      "parentUuid": "9338081f_acc194a8",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "eae68c95_8e7ec6f0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2022-08-30T18:39:07Z",
      "side": 1,
      "message": "It\u0027s on CQ, so no need to trigger it manually.",
      "parentUuid": "fb7aba24_db2a5877",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "84ee721d_37b623a2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002358
      },
      "writtenOn": "2022-08-30T21:49:35Z",
      "side": 1,
      "message": "-[MTLCommandBuffer waitUntilScheduled] has the same as glFlush with respect to IOSurfaces.\n\nAll work that has been waitUntilScheduled will be completed before an IOSurface is used by any subsequent commands.\n\nThose commands can be\n- sending the IOSurface to a CALayer for display\n- locking the IOSurface for CPU access (e.g, one copy canvas capture)\n\nSo this is likely to break those things. We\u0027d need to add a \"flush but for real\" command, and insert it in the appropriate places for this.",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "07f4fc55_48f4bccc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2022-08-31T00:08:54Z",
      "side": 1,
      "message": "Thanks very much for your insight Chris. Roughly where in Chromium\u0027s code base would we need to change to \"flush but for real\"? We could specify a new ANGLE extension. Or, can you think of other ways we could heuristically bypass the current too-expensive flush primitive?",
      "parentUuid": "84ee721d_37b623a2",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9b24ccf2_cff751d7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1543187
      },
      "writtenOn": "2022-08-31T01:44:37Z",
      "side": 1,
      "message": "I think Chromium\u0027s GL_COMMANDS_ISSUED_CHROMIUM queries could be appropriate places to insert [waitUntilScheduled]",
      "parentUuid": "07f4fc55_48f4bccc",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "53f8ed8d_462876c2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1543187
      },
      "writtenOn": "2022-08-31T02:11:23Z",
      "side": 1,
      "message": "GLImageBacking\u0027s GLTextureImageRepresentationBeginAccess/GLTextureImageRepresentationEndAccess could also be appropriate places to insert [waitUntilScheduled]\n\nhttps://source.chromium.org/chromium/chromium/src/+/main:gpu/command_buffer/service/shared_image/gl_image_backing.cc;drc\u003d5ffea9162c8890390f2565bf3db2bce0c31a3b40;l\u003d681\nhttps://source.chromium.org/chromium/chromium/src/+/main:gpu/command_buffer/service/shared_image/gl_image_backing.cc;drc\u003d5ffea9162c8890390f2565bf3db2bce0c31a3b40;l\u003d693",
      "parentUuid": "9b24ccf2_cff751d7",
      "revId": "58afdabc11fa7289aad5d7e3c87c16e303865701",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}