{
  "comments": [
    {
      "key": {
        "uuid": "d6c5fbf0_1d2a7714",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-01-06T19:33:15Z",
      "side": 1,
      "message": "At what point are we accessing an invalid framebuffer? And we will be accessing a nullptr framebuffer with your proposed fix. This seems also problematic. I suspect there might be an alternative solution.\n\nI\u0027d suggest putting back the bad code so we can track down where the problem is happening.",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 25,
        "endChar": 67
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58c27a74_e0f97b1b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-06T19:58:43Z",
      "side": 1,
      "message": "I just added a comment in ContextVk.cpp that explains it.  The problem is that ContextVk::mDrawFramebuffer is not always updated/pointing at valid memory.  PTAL.",
      "parentUuid": "d6c5fbf0_1d2a7714",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 25,
        "endChar": 67
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d328d918_c62cba49",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-07T01:16:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "58c27a74_e0f97b1b",
      "range": {
        "startLine": 21,
        "startChar": 0,
        "endLine": 25,
        "endChar": 67
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4ce17d68_abd46b96",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2128,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-06T19:58:43Z",
      "side": 1,
      "message": "Jamie, I originally used ContextVk::mDrawFramebuffer.  There were lots of random crashes.  I found that it is not always pointing to something valid, where glState.getDrawFramebuffer() always is.  I chased this for a while and found there are various ways that the draw framebuffer can be changed (including destroyed) without ContextVk being aware (i.e. no plumbing for updating mDrawFramebuffer).\n\nIt seems to me that we should remove ContextVk::mDrawFramebuffer as it\u0027s redundant and not always valid.  However, I wondered if this was a case (like ImageHelper::mSamples) where it\u0027s intentional that the value is not always valid, and I was just unaware of the undocumented rules for when it is safe for using it.  I later saw some other ContextVk code using glState.getDrawFramebuffer(), and so I went with that.\n\nHow would you like to proceed?",
      "range": {
        "startLine": 2128,
        "startChar": 47,
        "endLine": 2128,
        "endChar": 75
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a585aee_f50df654",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2128,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-06T20:01:28Z",
      "side": 1,
      "message": "BTW, I meant to bring this up, but most people were gone last week.",
      "parentUuid": "4ce17d68_abd46b96",
      "range": {
        "startLine": 2128,
        "startChar": 47,
        "endLine": 2128,
        "endChar": 75
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b59a9969_a71d4221",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2128,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-01-06T20:02:15Z",
      "side": 1,
      "message": "I\u0027m fine with using glState.getDrawFramebuffer. I\u0027d like the onDestroy additional logic reverted as I\u0027d rather chase down where we\u0027re using in incorrectly. mDrawFraembuffer only gets updated on syncState.\n\nRemoving these little cache variables is probably fine. I originally added them as a micro-optimization. It might not actually save that many instructions or memory accesses. I\u0027d either defer that or move it to a split patch.",
      "parentUuid": "4ce17d68_abd46b96",
      "range": {
        "startLine": 2128,
        "startChar": 47,
        "endLine": 2128,
        "endChar": 75
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cf5c0c3d_1ab6875d",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2128,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-07T01:16:50Z",
      "side": 1,
      "message": "Okay,\n\nI removed the onDestroy change.  Since I\u0027m no longer using ContextVk::mDrawFramebuffer, I don\u0027t think I need it now.\n\nI\u0027ll defer removing mDrawFramebuffer to a split patch.",
      "parentUuid": "b59a9969_a71d4221",
      "range": {
        "startLine": 2128,
        "startChar": 47,
        "endLine": 2128,
        "endChar": 75
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "152de2f7_3720ddf0",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2135,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-01-06T19:33:15Z",
      "side": 1,
      "message": "seems wiser to do this in onDrawFramebufferChange, right?",
      "range": {
        "startLine": 2125,
        "startChar": 0,
        "endLine": 2135,
        "endChar": 1
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f81e0d64_c649b651",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2135,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-06T19:58:43Z",
      "side": 1,
      "message": "I went with Shabi\u0027s proposal to create this function that the current code and syncState can both call.\n\nAre you both agreed to move it?",
      "parentUuid": "152de2f7_3720ddf0",
      "range": {
        "startLine": 2125,
        "startChar": 0,
        "endLine": 2135,
        "endChar": 1
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de2461f2_3f694669",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2135,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-01-06T20:02:15Z",
      "side": 1,
      "message": "You shouldn\u0027t need to add a new public method even if you want to make a helper method b/w syncState and onDrawFBChange.",
      "parentUuid": "f81e0d64_c649b651",
      "range": {
        "startLine": 2125,
        "startChar": 0,
        "endLine": 2135,
        "endChar": 1
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b2091e5_e3c2cc21",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2135,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-07T01:16:50Z",
      "side": 1,
      "message": "I\u0027m not sure I understand the comment about a new public method.  It\u0027s like the methods around it (in both the header/cpp files).\n\nI\u0027ll work on the onDrawFBChange tomorrow.",
      "parentUuid": "de2461f2_3f694669",
      "range": {
        "startLine": 2125,
        "startChar": 0,
        "endLine": 2135,
        "endChar": 1
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6478f55d_2620cfbf",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2135,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-01-07T17:10:09Z",
      "side": 1,
      "message": "I understand now that I moved the change from FramebuffVk::syncState to ContextVk::onDrawFramebufferChange.  Thanks Jamie!",
      "parentUuid": "3b2091e5_e3c2cc21",
      "range": {
        "startLine": 2125,
        "startChar": 0,
        "endLine": 2135,
        "endChar": 1
      },
      "revId": "e3b6353a9ed14b6a76925d079f775cfc60179d03",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}