{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ad48f375_9776becb",
        "filename": "src/compiler/translator/TranslatorMetal.cpp",
        "patchSetId": 14
      },
      "lineNbr": 244,
      "author": {
        "id": 1374244
      },
      "writtenOn": "2020-11-06T07:54:19Z",
      "side": 1,
      "message": "Why do you need to duplicate the whole TranslatorVulkan::AddGraphicsDriverUniformsToShader method?\nI would use the old createAdditionalGraphicsDriverUniformFields() and just add \"flipXY\" \u0026 \"negFlipXY\" to fieldsOut. createAdditionalGraphicsDriverUniformFields() adds Metal specific fields to driver uniforms. The rest of driver uniform fields can still be shared between vulkan and metal.\n\nIMO whatever fields are needed in TranslatorVulkan.cpp should be kept there, we shouldn\u0027t have a duplicated declaration here. Otherwise everytime you change some driver uniform specific code in TranslatorVulkan.cpp, you would have to change TranslatorMetal.cpp as well. For example, in future, some one might decide to remove `kViewport` and its related code from TranslatorVulkan.cpp, they would have to remove it from TranslatorMetal.cpp also.",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 244,
        "endChar": 94
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b371b174_5dc43065",
        "filename": "src/compiler/translator/TranslatorMetal.cpp",
        "patchSetId": 14
      },
      "lineNbr": 244,
      "author": {
        "id": 1374244
      },
      "writtenOn": "2020-11-06T10:22:03Z",
      "side": 1,
      "message": "i suggest using the old createAdditionalGraphicsDriverUniformFields() method to add flipping fields to the driver uniforms. Since these fields now are moved to the end of the driver uniforms struct, we need to update Metal backend also (ContextMtl.h).\nThis requires some minor changes in Metal backend but it is cleaner approach imo.",
      "parentUuid": "ad48f375_9776becb",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 244,
        "endChar": 94
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "528feb74_a45fd734",
        "filename": "src/compiler/translator/TranslatorMetal.cpp",
        "patchSetId": 14
      },
      "lineNbr": 244,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-11-12T22:30:43Z",
      "side": 1,
      "message": "The problem with createAdditionalGraphicsDriverUniformFields is that it only able to handle adding new field at the end. In this case, we are removing some field in the middle of array. And there is on going effort to further reduce the number of driver uniforms and I don\u0027t want to touch Metal side for now since I can\u0027t test it. But with the latest CLs, this has been reworked a bit, now the duplicated code are much smaller now. so please take a look again to see if you like it or not.",
      "parentUuid": "b371b174_5dc43065",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 244,
        "endChar": 94
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b02ed054_7b6c936b",
        "filename": "src/compiler/translator/TranslatorMetal.cpp",
        "patchSetId": 14
      },
      "lineNbr": 244,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-11-13T00:43:36Z",
      "side": 1,
      "message": "How much work is it to just move those to the end of the struct so we can use createAdditionalGraphicsDriverUniformFields()?   That feels like the right approach if we can avoid the duplication.   As for testing, I believe parts of dEQP are enabled for the Metal backend, if you have a mac.\n\nIf this really is worth a separate CL, it should probably have a bug and TODO so we come back to it.",
      "parentUuid": "528feb74_a45fd734",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 244,
        "endChar": 94
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4838fd16_bc503baa",
        "filename": "src/compiler/translator/TranslatorMetal.cpp",
        "patchSetId": 14
      },
      "lineNbr": 244,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-11-13T01:49:48Z",
      "side": 1,
      "message": "The work isn\u0027t much, but will have to change metal\u0027s context code as well which I am trying to avoid since if it fails, I don\u0027t have setup to debug locally. Once http://anglebug.com/5339 is fixed, these duplicated code will be deleted from Metal backend, so it is temporary. If people all feeling strongly on this, I will change it.",
      "parentUuid": "b02ed054_7b6c936b",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 244,
        "endChar": 94
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "be93e25c_672bc06d",
        "filename": "src/compiler/translator/TranslatorMetal.cpp",
        "patchSetId": 14
      },
      "lineNbr": 244,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-11-13T02:34:22Z",
      "side": 1,
      "message": "Never mind, I just did it anyway.",
      "parentUuid": "4838fd16_bc503baa",
      "range": {
        "startLine": 243,
        "startChar": 0,
        "endLine": 244,
        "endChar": 94
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aa7aba5f_c2f12317",
        "filename": "src/compiler/translator/TranslatorMetal.h",
        "patchSetId": 14
      },
      "lineNbr": 41,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-11-06T17:54:51Z",
      "side": 1,
      "message": "nit: specialization",
      "range": {
        "startLine": 41,
        "startChar": 24,
        "endLine": 41,
        "endChar": 35
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "79798773_64c82671",
        "filename": "src/compiler/translator/TranslatorMetal.h",
        "patchSetId": 14
      },
      "lineNbr": 41,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-11-12T22:30:43Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "aa7aba5f_c2f12317",
      "range": {
        "startLine": 41,
        "startChar": 24,
        "endLine": 41,
        "endChar": 35
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dd682e62_5798f97f",
        "filename": "src/compiler/translator/TranslatorVulkan.cpp",
        "patchSetId": 14
      },
      "lineNbr": 1112,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-11-06T17:54:51Z",
      "side": 1,
      "message": "SH_USE_ROTATION_SPECCONST was removed, so this can be updated/removed too.",
      "range": {
        "startLine": 1111,
        "startChar": 0,
        "endLine": 1112,
        "endChar": 60
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8719aa9f_be18e1ed",
        "filename": "src/compiler/translator/TranslatorVulkan.cpp",
        "patchSetId": 14
      },
      "lineNbr": 1112,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-11-12T22:30:43Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dd682e62_5798f97f",
      "range": {
        "startLine": 1111,
        "startChar": 0,
        "endLine": 1112,
        "endChar": 60
      },
      "revId": "a124ee21d3cc4cfda912669c5733f27d8867b7e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}