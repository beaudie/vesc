{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "1d332e7d_ccef09aa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1393148
      },
      "writtenOn": "2020-11-12T10:05:30Z",
      "side": 1,
      "message": "Please review.\nBased on EGLPreRotationBlitFramebufferTest.BlitStencilWithFlip test which can\u0027t get right result on android and is skipped if it\u0027s android, this patch is used to fix two issue about FramebufferVk::blit().\n1: If there is flipx/y added by glBlitFramebuffer API, the blit implementation will lose the API flip because it sets the flipx/y to true/false forcely in AdjustBlitResolveParametersForPreRotation().\n2: If the src framebuffer is default framebuffer 0, the flip info will be wrong because {x,y} is equal to {y,x} of default dst framebuffer in 90/270 degree. So I add swap() in AdjustFramebufferDimensionsForPreRotation() and rename the function.\n\nThere are two new end2end to test colorBlit in x/y-flip. They can pass on my local android, if they get failures on other platform, SKIP code should be added.\n\nWithout the patch, the BlitStencilWithFlip test gets totally wrong results. With the patch, it still failed on the boundaries. So it\u0027s still skipped on android now.\nThe while() code added in tests is related to the reported issue: https://issuetracker.google.com/issues/172867704",
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "44da870d_6600ab29",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-11-12T16:17:45Z",
      "side": 1,
      "message": "Thanks for the fix and the tests! I had suspicions about flip not being handled correctly, and this definitely looks more sensible to me.",
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c0a4429e_9a5b2e2e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-11-12T16:21:47Z",
      "side": 1,
      "message": "As a bonus, if you could port a simplified version of some of these tests to BlitFramebufferANGLETest.cpp, similar to TEST_P(BlitFramebufferANGLETest, BlitColorToDefault) (in the same test suite), we could verify the fix with desktop GPUs too.\n\nNot a blocking request.",
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8a29e66d_7a75fa37",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-11-12T20:21:52Z",
      "side": 1,
      "message": "Ian did you want to sign off?",
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "54efd4c9_c9b10675",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1393148
      },
      "writtenOn": "2020-11-13T10:06:22Z",
      "side": 1,
      "message": "Thanks Shahbaz. Excited to see the support of emulated pre-rotation, it\u0027ll help a lot to test implementation about pre-rotation.\nThe BlitFramebufferANGLETest.BlitColorWithFlip end2end has been added, I use glBlitFramebuffer() instead of glBlitFramebufferANGLE() which can\u0027t support flip.",
      "parentUuid": "c0a4429e_9a5b2e2e",
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "49cd631d_7e9b4a26",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-11-13T18:53:33Z",
      "side": 1,
      "message": "Yes.  Sorry, got distracted yesterday.",
      "parentUuid": "8a29e66d_7a75fa37",
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bf5c7d79_90e8f07e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-11-13T20:22:15Z",
      "side": 1,
      "message": "Thanks!\n\nRe: glBlitFramebuffer, that\u0027s correct. The test suite should probably be renamed to be less confusing.",
      "parentUuid": "54efd4c9_c9b10675",
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "613e83ea_86a2667f",
        "filename": "src/tests/egl_tests/EGLPreRotationTest.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1237,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-11-12T20:21:52Z",
      "side": 1,
      "message": "what\u0027s the intent behind the while loop? wondering if this can lead to odd behaviour. can you leave a comment?",
      "range": {
        "startLine": 1236,
        "startChar": 0,
        "endLine": 1237,
        "endChar": 5
      },
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "976925ec_12d01a13",
        "filename": "src/tests/egl_tests/EGLPreRotationTest.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1237,
      "author": {
        "id": 1393148
      },
      "writtenOn": "2020-11-13T10:06:22Z",
      "side": 1,
      "message": "According to https://issuetracker.google.com/issues/172867704, angle::Sleep(1000) can\u0027t ensure that the window has been changed, so adding the while() function to wait might be necessary. But I think this hasn\u0027t been 100% confirmed. If you are worried that this can lead to odd behaviour, I\u0027ll delete this since it won\u0027t affect the local results.",
      "parentUuid": "613e83ea_86a2667f",
      "range": {
        "startLine": 1236,
        "startChar": 0,
        "endLine": 1237,
        "endChar": 5
      },
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e7b94760_f3784657",
        "filename": "src/tests/egl_tests/EGLPreRotationTest.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1237,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-11-13T12:28:06Z",
      "side": 1,
      "message": "Ack, mostly worried that the wait could lead to slow tests. Seems to pass on the bots though so I\u0027m fine if you want to leave it for now.",
      "parentUuid": "976925ec_12d01a13",
      "range": {
        "startLine": 1236,
        "startChar": 0,
        "endLine": 1237,
        "endChar": 5
      },
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0715d2c2_909f3b5e",
        "filename": "src/tests/egl_tests/EGLPreRotationTest.cpp",
        "patchSetId": 1
      },
      "lineNbr": 1237,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-11-13T21:26:30Z",
      "side": 1,
      "message": "I did some testing for this test.  I removed this while loop, and the test still passed.  I also removed the sleep and the test still passed.  Interesting.  I didn\u0027t use logcat debugging to check, just test passing.  It may be safe to remove.  I\u0027m not sure.",
      "parentUuid": "e7b94760_f3784657",
      "range": {
        "startLine": 1236,
        "startChar": 0,
        "endLine": 1237,
        "endChar": 5
      },
      "revId": "3232413e995ddddb7dfa68c711153072e953417f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}