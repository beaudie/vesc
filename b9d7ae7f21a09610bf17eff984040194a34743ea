{
  "comments": [
    {
      "key": {
        "uuid": "9c2c6a50_adfca0eb",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 56,
      "author": {
        "id": 1105324
      },
      "writtenOn": "2019-02-05T00:11:13Z",
      "side": 1,
      "message": "nit: by convention context should be the first argument.",
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "52b5555f_c1cc405f",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 56,
      "author": {
        "id": 1117350
      },
      "writtenOn": "2019-02-05T01:11:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9c2c6a50_adfca0eb",
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ac0a5f03_8a6db381",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 137,
      "author": {
        "id": 1105324
      },
      "writtenOn": "2019-02-05T00:11:13Z",
      "side": 1,
      "message": "this is new - is this necessary?",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 137,
        "endChar": 49
      },
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "04062b73_3a3f7e9d",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 137,
      "author": {
        "id": 1117350
      },
      "writtenOn": "2019-02-05T01:11:44Z",
      "side": 1,
      "message": "The test passes without this. However, I am not sure of the correctness without it in all cases. The correct program must be current when calling beginTransformFeedback. I am not sure that it is always guaranteed to be set before syncActiveState is called. This ensures that it will be correct. It should be pretty cheap because the call will return early if the correct program is already current.\n\nI can remove this if you are confident that all callers of syncActiveState will ensure the correct program is current first.",
      "parentUuid": "ac0a5f03_8a6db381",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 137,
        "endChar": 49
      },
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1ea0bdd_85efdda9",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 137,
      "author": {
        "id": 1105324
      },
      "writtenOn": "2019-02-05T14:22:32Z",
      "side": 1,
      "message": "I think we\u0027re safe to delete the useProgram. End is the one call that triggers this sync immediately. All the other paths will have called StateManagerGL::syncState. And the spec says it\u0027s an error if we resume after a change to the program:\n\nThe error INVALID_OPERATION is generated:\n\nby ResumeTransformFeedback if the program object being used by the\ncurrent transform feedback object is not active or has been re-linked since\ntransform feedback became active for the current transform feedback object;\n\nYou could add a getProgramID() to StateManagerGL and ASSERT that it matches mActiveProgram.",
      "parentUuid": "04062b73_3a3f7e9d",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 137,
        "endChar": 49
      },
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a2b6cda3_a150dd5b",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 137,
      "author": {
        "id": 1117350
      },
      "writtenOn": "2019-02-08T21:57:12Z",
      "side": 1,
      "message": "I just realized that this useProgram is required after all. Because syncActiveState is called lazily, the current program is not necessarily the one that was bound when the application called BeginTransformFeedback. We have to ask the current transform feedback object what the right program to use is and bind that one.\n\nI\u0027ve added a test that requires this.",
      "parentUuid": "d1ea0bdd_85efdda9",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 137,
        "endChar": 49
      },
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "161de6f9_5ed162c5",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 150,
      "author": {
        "id": 1105324
      },
      "writtenOn": "2019-02-05T00:11:13Z",
      "side": 1,
      "message": "you probably don\u0027t need to store mActiveProgram.",
      "range": {
        "startLine": 150,
        "startChar": 42,
        "endLine": 150,
        "endChar": 56
      },
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "615fc29a_6566fcbc",
        "filename": "src/libANGLE/renderer/gl/TransformFeedbackGL.cpp",
        "patchSetId": 6
      },
      "lineNbr": 150,
      "author": {
        "id": 1117350
      },
      "writtenOn": "2019-02-05T01:11:44Z",
      "side": 1,
      "message": "mActiveProgram needs to be stored because it is the program that was current when the transform feedback object became active (when beginTransformFeedback was called), not the current active program in the context state.",
      "parentUuid": "161de6f9_5ed162c5",
      "range": {
        "startLine": 150,
        "startChar": 42,
        "endLine": 150,
        "endChar": 56
      },
      "revId": "b9d7ae7f21a09610bf17eff984040194a34743ea",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}