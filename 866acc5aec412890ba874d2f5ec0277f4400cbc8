{
  "comments": [
    {
      "key": {
        "uuid": "2193d4ce_687b9ca8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-10-02T21:52:35Z",
      "side": 1,
      "message": "PTAL",
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4486bbe3_3617e370",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T21:56:42Z",
      "side": 1,
      "message": "What about the idea of merging this with the next CL so we can see what the new APIs are used for?",
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "51d1900e_51317528",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-10-02T22:17:36Z",
      "side": 1,
      "message": "The next CL just send out to review.",
      "parentUuid": "4486bbe3_3617e370",
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "66645e97_7f9c93e3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-05T17:56:15Z",
      "side": 1,
      "message": "LGTM with nits.",
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "420fc70b_d5d0ef88",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 27,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-05T17:56:15Z",
      "side": 1,
      "message": "nit: can omit this",
      "range": {
        "startLine": 27,
        "startChar": 21,
        "endLine": 27,
        "endChar": 39
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b5978682_c3ac5197",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T21:56:42Z",
      "side": 1,
      "message": "-1 to duplicating the cache here.",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a69b251b_b973f74c",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-10-02T22:17:36Z",
      "side": 1,
      "message": "Sorry, what do you mean, Is there other places caching all shared contexts?",
      "parentUuid": "b5978682_c3ac5197",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2f8787d8_9e38ee04",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T22:23:56Z",
      "side": 1,
      "message": "Don\u0027t need to cache them, since they\u0027re available from the egl::Display, which is a member of RendererVk.",
      "parentUuid": "a69b251b_b973f74c",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b608989f_6ed8a8af",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-10-02T22:28:43Z",
      "side": 1,
      "message": "Display::mContextSet is all contexts in the processes, regardless if in the same share group or not. What I need here is a set of contexts within the same share group. Access to the same share group contexts is thread safe. Access to all contexts is not thread safe.",
      "parentUuid": "2f8787d8_9e38ee04",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bb0a410b_fde8500e",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T23:08:23Z",
      "side": 1,
      "message": "OK, can you figure out how to refactor this so the share group Contexts are stored in the front-end egl::ShareGroup? This is a good time to do it.",
      "parentUuid": "b608989f_6ed8a8af",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4517726d_a5b1c75d",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T23:22:54Z",
      "side": 1,
      "message": "Charlie reached out to me on IM and asked if he would be allowed to keep it in the back-end. That\u0027s fine. Main reason is I\u0027m not sure how this can ever be thread-safe.",
      "parentUuid": "bb0a410b_fde8500e",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b124d2c3_b9309981",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-10-02T23:43:02Z",
      "side": 1,
      "message": "The thread safe thing has nothing to do with front end back end though. There is an existing bug that Courtney found https://issuetracker.google.com/169847078. We should be good once that is fixed. As we discussed in the previous meeting, EGLImage may still have issues if used on two non-shared contexts, but we also agreed that we will deal with it separetely, tracked by http://b/169868803. (I believe there are general threading issues with EGLImage used on two non-shared contexts, not just when ImageHelper get released).\n\nBut anyway, moving the shared context tracking to front end is orthogonal issue to threading. I can move it to front end, but access it will mean another extra indirection from gl::Context to implementation and then cast to ContextVk. Right now front end does not have such need, so I figured leave it in back end probably is enough. But anyway, I will move it to front end at next update, along with absorbing other feedbacks.",
      "parentUuid": "4517726d_a5b1c75d",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "553a658e_93660db2",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T23:45:21Z",
      "side": 1,
      "message": "Unfortunately the thread safe has everything to do with front-end back-end. If you put the list in the front-end, the list could be modified by a CreateContext call.",
      "parentUuid": "b124d2c3_b9309981",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9bb9f81d_3c38b6da",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-10-02T23:48:45Z",
      "side": 1,
      "message": "Okay, will move to front end in the next update. Thanks for your time (I know its friday night your time).",
      "parentUuid": "553a658e_93660db2",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36377b74_1ab3b5a5",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T23:58:16Z",
      "side": 1,
      "message": "To reiterate: front-end is not thread-safe.",
      "parentUuid": "9bb9f81d_3c38b6da",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c94955bd_b6962682",
        "filename": "src/libANGLE/renderer/vulkan/DisplayVk.h",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-05T17:56:15Z",
      "side": 1,
      "message": "Per offline discussion - happy to keep this design and re-visit it when / if we run into another back-end that needs this list. Or the front-end.",
      "parentUuid": "36377b74_1ab3b5a5",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 45,
        "endChar": 37
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "76df7ac7_d5887cb2",
        "filename": "src/libANGLE/renderer/vulkan/ImageVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 37,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T21:56:42Z",
      "side": 1,
      "message": "nit: for TODO please use all upper case",
      "range": {
        "startLine": 37,
        "startChar": 11,
        "endLine": 37,
        "endChar": 15
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba81962d_4ac471dd",
        "filename": "src/libANGLE/renderer/vulkan/android/HardwareBufferImageSiblingVkAndroid.cpp",
        "patchSetId": 5
      },
      "lineNbr": 316,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-05T17:56:15Z",
      "side": 1,
      "message": "same nit",
      "range": {
        "startLine": 316,
        "startChar": 11,
        "endLine": 316,
        "endChar": 15
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5bbe63de_b684e107",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 5
      },
      "lineNbr": 878,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-05T17:56:15Z",
      "side": 1,
      "message": "same nit",
      "range": {
        "startLine": 878,
        "startChar": 7,
        "endLine": 878,
        "endChar": 11
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0842b380_697d4f84",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 5
      },
      "lineNbr": 3056,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-02T21:56:42Z",
      "side": 1,
      "message": "nit: you can use the explicit type here.",
      "range": {
        "startLine": 3056,
        "startChar": 13,
        "endLine": 3056,
        "endChar": 17
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f744361d_91395966",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.h",
        "patchSetId": 5
      },
      "lineNbr": 1322,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-10-05T17:56:15Z",
      "side": 1,
      "message": "nit: instead of making this optionally nullptr, can you make two release functions?\n\nreleaseImageAndUpdateRenderPass(contextvk)\nreleaseImage(renderer)\n\nnaming can change but that\u0027s the general idea.",
      "range": {
        "startLine": 1322,
        "startChar": 3,
        "endLine": 1322,
        "endChar": 66
      },
      "revId": "866acc5aec412890ba874d2f5ec0277f4400cbc8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}