{
  "comments": [
    {
      "key": {
        "uuid": "434cf050_6c1c6dbb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-07-27T18:36:20Z",
      "side": 1,
      "message": "The setDepthBufferEnabled()/setStencilBufferEnabled() calls can definitely be moved outside of the setupDraw() hot path. They should be called when the relevant state change dirty bit is handled and right after the startRenderPass call in setupDraw().\n\nAlso, can you please add the following two tests? They can go in StateChangeTests.cpp:\n\n1. A test that performs a few draws, only one of which enables depth test. The test then invalidates the depth buffer. It should not set loadOp to DONT_CARE otherwise it would fail on Android. This could actually be two similar tests, one where the draw with depth test is the first draw, one where it\u0027s not the first draw.\n2. A test that performs a few draws with depth test disabled followed by an invalidate. It won\u0027t catch a regression if loadOp is not changed, but hopefully would catch bugs on future iterations of this optimization.",
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "15d59f22_9985b678",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 970,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-07-27T18:36:20Z",
      "side": 1,
      "message": "nit: we use {} around single-line blocks too per style guide.\n\nIf an application is found to set for example glDepthFunc(GL_ALWAYS), that could also count as not having depth test enabled. Not sure if it\u0027s worth considering, so maybe keep such things in mind if such an application is discovered.",
      "range": {
        "startLine": 966,
        "startChar": 0,
        "endLine": 970,
        "endChar": 55
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97ce2d2d_690422b9",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 970,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-07-27T19:33:56Z",
      "side": 1,
      "message": "This is the part Shabi recommends should move to state setup rather than in setupDraw.",
      "parentUuid": "15d59f22_9985b678",
      "range": {
        "startLine": 966,
        "startChar": 0,
        "endLine": 970,
        "endChar": 55
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab92f556_2ea97548",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 970,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-07-27T21:12:55Z",
      "side": 1,
      "message": "Yes, this was mean to be my quick hack. I was thinking to do under dirty bit but forgot it afterwards.",
      "parentUuid": "97ce2d2d_690422b9",
      "range": {
        "startLine": 966,
        "startChar": 0,
        "endLine": 970,
        "endChar": 55
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a71705a_c5647626",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1986,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-07-27T19:33:56Z",
      "side": 1,
      "message": "Nit: Use depthStencilAttachmentIndex now that we\u0027ve created it for clarity?\nMore uses below.",
      "range": {
        "startLine": 1986,
        "startChar": 43,
        "endLine": 1986,
        "endChar": 65
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6c11a4c_b3cb35cd",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1986,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-07-27T21:12:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3a71705a_c5647626",
      "range": {
        "startLine": 1986,
        "startChar": 43,
        "endLine": 1986,
        "endChar": 65
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5917f4bd_52523ccc",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 2045,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-07-27T19:33:56Z",
      "side": 1,
      "message": "Initialize to vk::kInvalidAttachmentIndex and should be able to drop this else.",
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8edbbea2_a6879de0",
        "filename": "src/libANGLE/renderer/vulkan/FramebufferVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 2045,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-07-27T21:12:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5917f4bd_52523ccc",
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "86fc37fd_f33d918f",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 668,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-07-27T18:36:20Z",
      "side": 1,
      "message": "typo: has",
      "range": {
        "startLine": 668,
        "startChar": 18,
        "endLine": 668,
        "endChar": 20
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5894e16_3a232028",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 668,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-07-27T18:36:20Z",
      "side": 1,
      "message": "typo: has",
      "range": {
        "startLine": 668,
        "startChar": 49,
        "endLine": 668,
        "endChar": 51
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2f1ff108_c3283947",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 668,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-07-27T21:12:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "86fc37fd_f33d918f",
      "range": {
        "startLine": 668,
        "startChar": 18,
        "endLine": 668,
        "endChar": 20
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3e6ca3aa_82c633e3",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 668,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2020-07-27T21:12:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e5894e16_3a232028",
      "range": {
        "startLine": 668,
        "startChar": 49,
        "endLine": 668,
        "endChar": 51
      },
      "revId": "abdd8d883afc3bb30784e4b96e6ce54e44df7c64",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}