{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "8c5ad506_56037909",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2021-03-31T18:06:47Z",
      "side": 1,
      "message": "nit: has",
      "range": {
        "startLine": 10,
        "startChar": 53,
        "endLine": 10,
        "endChar": 55
      },
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "367f8828_08fc265a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-03-31T21:35:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8c5ad506_56037909",
      "range": {
        "startLine": 10,
        "startChar": 53,
        "endLine": 10,
        "endChar": 55
      },
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5bb4e553_0d7ddaca",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-03-31T17:54:24Z",
      "side": 1,
      "message": "No comments beyond what Shabi said.",
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a5786398_dc63b05e",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1293,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-03-31T21:03:02Z",
      "side": 1,
      "message": "Ref. Old mImage released here.",
      "range": {
        "startLine": 1290,
        "startChar": 4,
        "endLine": 1293,
        "endChar": 5
      },
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d50b6d6b_504a7511",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1916,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2021-03-31T17:55:58Z",
      "side": 1,
      "message": "Given the change in parameters (with a reliance on DIRTY_BIT_{MAX|BASE}_LEVEL, it seems like this can\u0027t happen.  Therefore, we should assert this will never happen.\n\nOtherwise, there\u0027s a problem and we need the old \"previous{Base|Max}Level variables/logic.",
      "range": {
        "startLine": 1916,
        "startChar": 4,
        "endLine": 1916,
        "endChar": 47
      },
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a4041e87_3f19a834",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1916,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-03-31T21:03:02Z",
      "side": 1,
      "message": "Good point!",
      "parentUuid": "d50b6d6b_504a7511",
      "range": {
        "startLine": 1916,
        "startChar": 4,
        "endLine": 1916,
        "endChar": 47
      },
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9155a32f_83bbcbc8",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1932,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-03-31T03:05:05Z",
      "side": 1,
      "message": "Please add a test that does this:\n\n- Define a texture with glTexImage2D\n- Use it with non-zero base (like sample from it)\n- Redefine the texture with glTexStorage2D\n- Use it and make sure everything is correct\n\nSince this is conditioned to !mState.getImmutableFormat(), it looks like mFirstAllocatedLevel will be stuck at the old base level after the texture is redefined.",
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "438ca8e4_f092cee6",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1932,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-03-31T17:02:43Z",
      "side": 1,
      "message": "In the sequence you dexcribed above, because in the previous CL crrev.com/c/2368038 glTexStorage2D will call setStorage immediately, which calls TextureVk::setStorageMultisample. The first thing it does is call releaseAndDeleteImageAndViews and then call initImmutableImage. Everything is going to start with a new VkImage.",
      "parentUuid": "9155a32f_83bbcbc8",
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3e6d8170_cf691556",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1932,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-03-31T17:30:15Z",
      "side": 1,
      "message": "Great. A regression test for that would be perfect.",
      "parentUuid": "438ca8e4_f092cee6",
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "11ca9c47_0cbac8b2",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1932,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2021-03-31T17:55:58Z",
      "side": 1,
      "message": "\u003e Use it with non-zero base (like sample from it)\n\nClarifying question for Shabi: are you trying to get baseLevel to be non-0 before the glTexStorage2D call?\n\n\u003e ... The first thing it does is call releaseAndDeleteImageAndViews and then call initImmutableImage. Everything is going to start with a new VkImage.\n\nThat\u0027s only if !mOwnsImage.  Will that be the case in the scenario Shabi described?  I was going to look, but figured you already know.",
      "parentUuid": "9155a32f_83bbcbc8",
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "04653743_5d4dffc7",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1932,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-03-31T18:27:15Z",
      "side": 1,
      "message": "\u003e Clarifying question for Shabi: are you trying to get baseLevel to be non-0 before the glTexStorage2D call?\n\nYes.",
      "parentUuid": "11ca9c47_0cbac8b2",
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "34d935b8_1789c037",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1932,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-03-31T21:03:02Z",
      "side": 1,
      "message": "Test added. The old miutable texture will gets released from TextureVk::setStorageMultiSample line 1292 (see Ref).",
      "parentUuid": "04653743_5d4dffc7",
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0add6b0b_034c8cc0",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1977,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2021-03-31T17:55:58Z",
      "side": 1,
      "message": "Is this always guaranteed now to be the same as what previousBaseLevel would have been?",
      "range": {
        "startLine": 1977,
        "startChar": 53,
        "endLine": 1977,
        "endChar": 85
      },
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "379e42f4_a27e5cc3",
        "filename": "src/libANGLE/renderer/vulkan/TextureVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 1977,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2021-03-31T21:03:02Z",
      "side": 1,
      "message": "For immutable, it will return 0. Previously it will return actual mBaseLevel. So there is a change here. But this change is correct, because if you look at how this previousBaseLevel is been used by respecifyImageStorageAndLevels, it is used to convert the levelVk to levelGL, which means what you need here is the mFirstAllocatedLevel instead of mBaseLevel.",
      "parentUuid": "0add6b0b_034c8cc0",
      "range": {
        "startLine": 1977,
        "startChar": 53,
        "endLine": 1977,
        "endChar": 85
      },
      "revId": "b047e65125e6073cf32949d28892e2d11b091d4a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}