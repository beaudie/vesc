{
  "comments": [
    {
      "key": {
        "uuid": "c18f8d52_5558001e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-23T22:10:35Z",
      "side": 1,
      "message": "PTAL\n\nI took another pass that removed all of the dirty bit handling, since it doesn\u0027t appear necessary anymore.   This version feels a bit cleaner, aside from the special handling in Context::prepareForDispatch().   Maybe moving that into a helper in ProgramPipeline would be enough, but let me know.\n\nI\u0027m also not sure of a good way to handle linking either in the validation layer or not based on whether the validation layer exists, so let me know where you think we could fit that in.   Not using dirty bits means checking the PPO\u0027s link status on every draw call (not good), but keeping/reintroducing the dirty bits means having a separate linking code path which may not get exercised very often, since it sounds like this isn\u0027t something in CQ (also not good).   Is supporting this something that\u0027s necessary for this fix, or can we open a bug to tackle that later?",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e84f46ab_e21c355f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-24T04:31:01Z",
      "side": 1,
      "message": "Actually it looks like the no error extension is already done. See https://bugs.chromium.org/p/angleproject/issues/detail?id\u003d1280#c22\n\nCould you add a test in ContextNoErrorTest.cpp that creates a legitimate PPO and draws with it? Without the validation layer, the link won\u0027t happen and the test should fail. It\u0027s fine by me if you would just file a bug for it and promptly suppress it.",
      "parentUuid": "c18f8d52_5558001e",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0a46b214_65999643",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-24T12:58:31Z",
      "side": 1,
      "message": "Looking at the code I\u0027m not even sure Program linking is resolved before we draw.",
      "parentUuid": "e84f46ab_e21c355f",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1e623bfe_c695b1b2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-24T12:58:31Z",
      "side": 1,
      "message": "This looks like a strict improvement to me. There\u0027s more we could do, probably, in the future. LGTM, one comment is that we could do something similar to what we did in State.h for pipeline getters.",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "52c683e4_b34e7ff3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-24T12:58:31Z",
      "side": 1,
      "message": "Looking at the code I\u0027m not even sure Program linking is resolved before we draw.",
      "parentUuid": "e84f46ab_e21c355f",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3b18c790_f9d741b5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-24T12:58:31Z",
      "side": 1,
      "message": "Looking at the code I\u0027m not even sure Program linking is resolved before we draw. Maybe StateCache::updateCanDraw should force the executable update.",
      "parentUuid": "e84f46ab_e21c355f",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3990270e_8568c8d7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-24T12:58:31Z",
      "side": 1,
      "message": "Looking at the code I\u0027m not even sure Program linking is resolved before we draw. Maybe StateCache::updateCanDraw should force the executable update. This can probably be a separate change. Indeed it should be as it could affect draw call overhead more significantly.",
      "parentUuid": "e84f46ab_e21c355f",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "00059c06_14c28b45",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-24T12:59:02Z",
      "side": 1,
      "message": "Added Shabi to reviewers, as he\u0027s been leaving feedback.",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7fecfe25_7a5ff112",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-24T13:01:31Z",
      "side": 1,
      "message": "Sorry Tim, no idea why it spammed this 4 times.",
      "parentUuid": "52c683e4_b34e7ff3",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7d43c4b8_4a78e63c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-09-24T16:30:11Z",
      "side": 1,
      "message": "Re-LGTM",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b0f8f76_d6080d0a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-09-25T17:11:01Z",
      "side": 1,
      "message": "I added the test ContextNoErrorTest31.DrawWithPPO and opened http://anglebug.com/5102 to track fixing it.\n\nAs an experiment, I tried the following:\n1.) Run the test on ToT master (without this fix): PASS\n2.) Run the test with this fix: FAIL\n3.) Hack this fix to link the PPO in ContextVk::setupDraw(): PASS\n\nSo it seems the rest of ANGLE works well enough for this very simple PPO draw test, we just need to find a good way to link when that extension is enabled.",
      "parentUuid": "7fecfe25_7a5ff112",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "54c9015e_ec25e80a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-09-25T17:12:49Z",
      "side": 1,
      "message": "As I said earlier, I honestly wonder if the same bug persists for normal programs. Anyway happy to address these issues in other CLs.",
      "parentUuid": "9b0f8f76_d6080d0a",
      "revId": "11d81ec895a1d91b34898b70e74cbd262da041de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}