{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ef5d9341_215e7368",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1525982
      },
      "writtenOn": "2023-08-04T17:50:28Z",
      "side": 1,
      "message": "Thanks",
      "revId": "7525569c69d62f7f295324184e02ac5fa1733348",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fff6833c_d6008aee",
        "filename": "src/libANGLE/renderer/vulkan/RendererVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 5900,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-08-04T17:56:22Z",
      "side": 1,
      "message": "Also just noticed this, not directly related to this CL: It is odd to remove bits from requiredFlags. As the name indicates, requiredFlags is the bits are *required*. If we can remove the bits, it means the bit is not required. If device local is not required, then we should not set the bit in requiredFlags.",
      "range": {
        "startLine": 5900,
        "startChar": 0,
        "endLine": 5900,
        "endChar": 64
      },
      "revId": "7525569c69d62f7f295324184e02ac5fa1733348",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d99fee0_d47b6666",
        "filename": "src/libANGLE/renderer/vulkan/RendererVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 5900,
      "author": {
        "id": 1525982
      },
      "writtenOn": "2023-08-04T18:27:01Z",
      "side": 1,
      "message": "I believe we remove the bit here to prioritize the fallback of retrying the device memory after freeing garbage over using the system memory.",
      "parentUuid": "fff6833c_d6008aee",
      "range": {
        "startLine": 5900,
        "startChar": 0,
        "endLine": 5900,
        "endChar": 64
      },
      "revId": "7525569c69d62f7f295324184e02ac5fa1733348",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "267cdb55_d9401f03",
        "filename": "src/libANGLE/renderer/vulkan/RendererVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 5900,
      "author": {
        "id": 1392020
      },
      "writtenOn": "2023-08-04T20:49:42Z",
      "side": 1,
      "message": "Understood. What I am saying is that the API contract is broken here: at line 5835, caller passed in requiredFlags with DEICE_LOCAL_BIT, but we allocated memory without the bit, that is wrong. The correct way to do this is have the caller set DEICE_LOCAL_BIT in the preferredFlags and leave requiredFlags being 0, since it does not require to be device local. Then at line 5869, you can restrict it to DEVICE_LOCAL (you can either use a localRequiredFlags, or use memoryTypeBits to restrict it to device local), and if it failed, you try garbage clean up and then once come to here, you restrict it to exclude device local. That way it should still do what you want, but consistent to the API. You can do with a follow up CL since it is not directly tie to this CL.",
      "parentUuid": "6d99fee0_d47b6666",
      "range": {
        "startLine": 5900,
        "startChar": 0,
        "endLine": 5900,
        "endChar": 64
      },
      "revId": "7525569c69d62f7f295324184e02ac5fa1733348",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}