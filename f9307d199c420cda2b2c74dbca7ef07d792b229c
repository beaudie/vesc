{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "31fcc4b6_ac5dbc18",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1340649
      },
      "writtenOn": "2022-03-30T17:47:18Z",
      "side": 1,
      "message": "PTAL",
      "revId": "f9307d199c420cda2b2c74dbca7ef07d792b229c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c7907eca_e7106b15",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2022-03-31T16:09:39Z",
      "side": 1,
      "message": "LGTM",
      "revId": "f9307d199c420cda2b2c74dbca7ef07d792b229c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e2cf66f_2cc57955",
        "filename": "src/libANGLE/Surface.h",
        "patchSetId": 1
      },
      "lineNbr": 219,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2022-03-31T14:24:54Z",
      "side": 1,
      "message": "`release` usually has a different meaning in ANGLE. There\u0027s already a `releaseRef` in this class, why not use that? It also seems that this release is missing a check for `mRefCount \u003d\u003d 0`, like releaseRef does.",
      "range": {
        "startLine": 215,
        "startChar": 0,
        "endLine": 219,
        "endChar": 5
      },
      "revId": "f9307d199c420cda2b2c74dbca7ef07d792b229c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c480cd22_8f6337cf",
        "filename": "src/libANGLE/Surface.h",
        "patchSetId": 1
      },
      "lineNbr": 219,
      "author": {
        "id": 1340649
      },
      "writtenOn": "2022-03-31T15:48:25Z",
      "side": 1,
      "message": "\u003e why not use that?\n\n1. mirroring what ScopedContextRef did\n2. the sopedref should not destroy a surface, it just needs to keep an already destroyed surface alive during our internal context juggling\n\n\u003e release is missing a check for  mRefCount \u003d\u003d 0\n\nwill add",
      "parentUuid": "9e2cf66f_2cc57955",
      "range": {
        "startLine": 215,
        "startChar": 0,
        "endLine": 219,
        "endChar": 5
      },
      "revId": "f9307d199c420cda2b2c74dbca7ef07d792b229c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2827d01_0a090bcd",
        "filename": "src/libANGLE/Surface.h",
        "patchSetId": 1
      },
      "lineNbr": 219,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2022-03-31T15:56:12Z",
      "side": 1,
      "message": "\u003e 2. the sopedref should not destroy a surface, it just needs to keep an already destroyed surface alive during our internal context juggling\n\nOk got it, then using `releaseRef` would be wrong, because the surface is already destroyed (unless re-destroying it is safe)? If it\u0027s safe to re-destroy, you could just replace this with `releaseRef`. Or if this is expected to only be used for the keep-destroyed-alive situation, you could just `ASSERT(mRefCount \u003d\u003d 0 \u0026\u0026 mDestroyed);` with a comment.",
      "parentUuid": "c480cd22_8f6337cf",
      "range": {
        "startLine": 215,
        "startChar": 0,
        "endLine": 219,
        "endChar": 5
      },
      "revId": "f9307d199c420cda2b2c74dbca7ef07d792b229c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1848b1c5_6f9ca27a",
        "filename": "src/libANGLE/Surface.h",
        "patchSetId": 1
      },
      "lineNbr": 219,
      "author": {
        "id": 1340649
      },
      "writtenOn": "2022-03-31T16:05:17Z",
      "side": 1,
      "message": "\u003e If it\u0027s safe to re-destroy\n\nit is not, the object would be garbage after 1st destroy\n\n\u003e because the surface is already destroyed ... Or if this is expected to only be used for the keep-destroyed-alive situation\n\nupdating this comment -\u003e \"it just needs to keep an already destroyed surface alive during our internal context juggling\" to \"it just needs to keep a potentially destroyed surface alive during our internal context juggling\".\n\nI wanted to use the \"acquire\" / \"release\" pattern and not talk about ref at all but saw ScopedContextRef and thought you guys might want to continue the pattern",
      "parentUuid": "c2827d01_0a090bcd",
      "range": {
        "startLine": 215,
        "startChar": 0,
        "endLine": 219,
        "endChar": 5
      },
      "revId": "f9307d199c420cda2b2c74dbca7ef07d792b229c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1774f805_46a5afbe",
        "filename": "src/libANGLE/Surface.h",
        "patchSetId": 1
      },
      "lineNbr": 219,
      "author": {
        "id": 1340649
      },
      "writtenOn": "2022-03-31T16:17:51Z",
      "side": 1,
      "message": "\u003e release is missing a check for  mRefCount \u003d\u003d 0\n\nthinking about this again, an assert would crash and let developer know that a corresponding `addRef` is missing (instead of silently ignoring the call). WDYT?",
      "parentUuid": "1848b1c5_6f9ca27a",
      "range": {
        "startLine": 215,
        "startChar": 0,
        "endLine": 219,
        "endChar": 5
      },
      "revId": "f9307d199c420cda2b2c74dbca7ef07d792b229c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}