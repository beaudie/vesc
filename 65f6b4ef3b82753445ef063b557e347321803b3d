{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f8557fd9_b23bd8b3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-03-20T19:02:32Z",
      "side": 1,
      "message": "üëç",
      "revId": "65f6b4ef3b82753445ef063b557e347321803b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67bbb071_73c2ab93",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 7677,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-04-11T17:44:42Z",
      "side": 1,
      "message": "Avoid shortcircuit:\n\n```suggestion\n    const bool outsideRenderPassWritesToBuffer \u003d mOutsideRenderPassCommands-\u003egetAndResetHasHostVisibleBufferWrite();\n    const bool renderPassWritesToBuffer \u003d mRenderPassCommands-\u003egetAndResetHasHostVisibleBufferWrite();\n    if (mIsAnyHostVisibleBufferWritten || outsideRenderPassWritesToBuffer || renderPassWritesToBuffer)\n```",
      "range": {
        "startLine": 7675,
        "startChar": 0,
        "endLine": 7677,
        "endChar": 68
      },
      "revId": "65f6b4ef3b82753445ef063b557e347321803b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "49eeabf4_0c082ec1",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 7677,
      "author": {
        "id": 1603052
      },
      "writtenOn": "2024-04-11T20:06:43Z",
      "side": 1,
      "message": "Your suggestion on assert was spot on :). Done.",
      "parentUuid": "67bbb071_73c2ab93",
      "range": {
        "startLine": 7675,
        "startChar": 0,
        "endLine": 7677,
        "endChar": 68
      },
      "revId": "65f6b4ef3b82753445ef063b557e347321803b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "76700ab6_fd471867",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 7677,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-04-12T14:52:08Z",
      "side": 1,
      "message": "This should fix the CI (without it, `mIsAnyHostVisibleBufferWritten` is never set and the flag is lost for intermediate command buffers that are already flushed):\n\n```\ndiff --git a/src/libANGLE/renderer/vulkan/ContextVk.cpp b/src/libANGLE/renderer/vulkan/ContextVk.cpp\nindex f74f41bb1..c0103770b 100644\n--- a/src/libANGLE/renderer/vulkan/ContextVk.cpp\n+++ b/src/libANGLE/renderer/vulkan/ContextVk.cpp\n@@ -8010,6 +8010,11 @@ angle::Result ContextVk::flushCommandsAndEndRenderPassWithoutSubmit(RenderPassCl\n         addGarbage(\u0026tempFramebuffer);\n     }\n \n+    if (mRenderPassCommands-\u003egetAndResetHasHostVisibleBufferWrite())\n+    {\n+        mIsAnyHostVisibleBufferWritten \u003d true;\n+    }\n+\n     ANGLE_TRY(mRenderer-\u003eflushRenderPassCommands(this, getProtectionType(), mContextPriority,\n                                                  *renderPass, framebufferOverride,\n                                                  \u0026mRenderPassCommands));\n@@ -8271,6 +8276,11 @@ angle::Result ContextVk::flushOutsideRenderPassCommands()\n \n     flushDescriptorSetUpdates();\n \n+    if (mOutsideRenderPassCommands-\u003egetAndResetHasHostVisibleBufferWrite())\n+    {\n+        mIsAnyHostVisibleBufferWritten \u003d true;\n+    }\n+\n     // Save the queueSerial before calling flushOutsideRPCommands, which may return a new\n     // mOutsideRenderPassCommands\n     ASSERT(QueueSerialsHaveDifferentIndexOrSmaller(mLastFlushedQueueSerial,\n```",
      "parentUuid": "49eeabf4_0c082ec1",
      "range": {
        "startLine": 7675,
        "startChar": 0,
        "endLine": 7677,
        "endChar": 68
      },
      "revId": "65f6b4ef3b82753445ef063b557e347321803b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4ef33b53_c60aa178",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 6
      },
      "lineNbr": 7677,
      "author": {
        "id": 1603052
      },
      "writtenOn": "2024-04-12T16:26:41Z",
      "side": 1,
      "message": "Makes sense. Uploaded new version.",
      "parentUuid": "76700ab6_fd471867",
      "range": {
        "startLine": 7675,
        "startChar": 0,
        "endLine": 7677,
        "endChar": 68
      },
      "revId": "65f6b4ef3b82753445ef063b557e347321803b3d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}