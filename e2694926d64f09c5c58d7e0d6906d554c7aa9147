{
  "comments": [
    {
      "key": {
        "uuid": "80057758_f42fabeb",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.h",
        "patchSetId": 5
      },
      "lineNbr": 972,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T14:51:26Z",
      "side": 1,
      "message": "can\u0027t we get rid of this now? Or is it used in other places.",
      "range": {
        "startLine": 972,
        "startChar": 3,
        "endLine": 972,
        "endChar": 48
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9013f672_3ace2749",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.h",
        "patchSetId": 5
      },
      "lineNbr": 972,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-06-18T22:32:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "80057758_f42fabeb",
      "range": {
        "startLine": 972,
        "startChar": 3,
        "endLine": 972,
        "endChar": 48
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8a453f3f_73d7c69c",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-06-18T04:22:34Z",
      "side": 1,
      "message": "Is this really what we want? Bunch of temp views for some serial?",
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58db2ed8_fbde1cfd",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T14:51:26Z",
      "side": 1,
      "message": "We should store the serials in the ImageViewHelper. If you want to index them by level/layer that\u0027s fine.",
      "parentUuid": "8a453f3f_73d7c69c",
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7dc5bae9_c21e1891",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-06-18T22:32:00Z",
      "side": 1,
      "message": "Now caching Serials in ImageViewHelper by layer/level",
      "parentUuid": "58db2ed8_fbde1cfd",
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "64a84d29_5bcf2e0a",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 73,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T14:51:26Z",
      "side": 1,
      "message": "sounds good, please do.",
      "range": {
        "startLine": 73,
        "startChar": 4,
        "endLine": 73,
        "endChar": 100
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e1681a3_bc8faea0",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 73,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-06-18T22:32:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "64a84d29_5bcf2e0a",
      "range": {
        "startLine": 73,
        "startChar": 4,
        "endLine": 73,
        "endChar": 100
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e0a623b6_549c61a2",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 122,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-06-18T04:22:34Z",
      "side": 1,
      "message": "I\u0027m going to go ahead and guess the failing tests are due to this. I\u0027ve been meaning to take a look at it, but maybe you should while you\u0027re seeing this.\n\nPlease check to see if the level index given here is the GL level index or the VK level index (i.e. does it include the texture\u0027s base level (GL) or not (VK)). Then add the appropriate suffix (GL or VK) to the member variable for clarity. Additionally, see whether getLevelLayerDrawImageView wants a GL level index or a VK level index.\n\nMy guess is that this class stores GL level and the function expects a VK level. The failing tests use a non-zero base level.",
      "range": {
        "startLine": 122,
        "startChar": 71,
        "endLine": 122,
        "endChar": 82
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "49afbc59_39a291ad",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 122,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T14:51:26Z",
      "side": 1,
      "message": "The tests are failing because of OOM in Angry Birds 2. My guess is that the code above is creating too many ImageViews, but I\u0027m not sure.",
      "parentUuid": "e0a623b6_549c61a2",
      "range": {
        "startLine": 122,
        "startChar": 71,
        "endLine": 122,
        "endChar": 82
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0b5a3898_0dd69d86",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 122,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-06-18T14:55:01Z",
      "side": 1,
      "message": "We are probably talking about different failures. I was talking about the two suppressions that are added.",
      "parentUuid": "49afbc59_39a291ad",
      "range": {
        "startLine": 122,
        "startChar": 71,
        "endLine": 122,
        "endChar": 82
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b75d2d08_92fedb3f",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 122,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T16:01:16Z",
      "side": 1,
      "message": "Ack.",
      "parentUuid": "0b5a3898_0dd69d86",
      "range": {
        "startLine": 122,
        "startChar": 71,
        "endLine": 122,
        "endChar": 82
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e648220c_f4e077ad",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 5
      },
      "lineNbr": 122,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-06-18T22:32:00Z",
      "side": 1,
      "message": "Hmm, with updated caching of Serials this is no longer an issue. I looked at this for a bit before the change the only suspicious code was when RenderTargets were initialized for TextureVk, which does offset level:\nhttps://source.chromium.org/chromium/chromium/src/+/master:third_party/angle/src/libANGLE/renderer/vulkan/TextureVk.cpp;l\u003d1618;bpv\u003d1;bpt\u003d1?originalUrl\u003dhttps:%2F%2Fcs.chromium.org%2F\n\nThat made me think Shabi\u0027s suspicions were correct and the RenderTarget was storing GL level, but potentially ImageView wanted VK level.\n\nHowever, I\u0027m not sure if this is correct or if any action should be taking. Just noting this here for now, but since asserts are gone, not worrying about it for this CL.",
      "parentUuid": "b75d2d08_92fedb3f",
      "range": {
        "startLine": 122,
        "startChar": 71,
        "endLine": 122,
        "endChar": 82
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "da6b5d76_4d956a7a",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.h",
        "patchSetId": 5
      },
      "lineNbr": 1625,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T14:51:26Z",
      "side": 1,
      "message": "oh I see. Instead of indexing from the VkImageView, index from level/layer. The empty the cache when the level layer draw image views get recreated. You might be running OOM because of this design not ever emptying.",
      "range": {
        "startLine": 1625,
        "startChar": 23,
        "endLine": 1625,
        "endChar": 34
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b4c25918_b7a30b54",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.h",
        "patchSetId": 5
      },
      "lineNbr": 1625,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-06-18T22:32:00Z",
      "side": 1,
      "message": "Ok, I think I\u0027ve got this reasonable now. Let me know if I\u0027ve missed a simpler solution to storing serial per layer/level.",
      "parentUuid": "da6b5d76_4d956a7a",
      "range": {
        "startLine": 1625,
        "startChar": 23,
        "endLine": 1625,
        "endChar": 34
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c6916ef7_5d2caa7e",
        "filename": "src/tests/gl_tests/FramebufferTest.cpp",
        "patchSetId": 5
      },
      "lineNbr": 472,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T14:51:26Z",
      "side": 1,
      "message": "we should re-enable this before landing.",
      "range": {
        "startLine": 471,
        "startChar": 0,
        "endLine": 472,
        "endChar": 43
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1d1c6eea_e192cad0",
        "filename": "src/tests/gl_tests/FramebufferTest.cpp",
        "patchSetId": 5
      },
      "lineNbr": 472,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-06-18T22:32:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c6916ef7_5d2caa7e",
      "range": {
        "startLine": 471,
        "startChar": 0,
        "endLine": 472,
        "endChar": 43
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6336f37f_773811aa",
        "filename": "src/tests/gl_tests/TextureTest.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2551,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-06-18T14:51:26Z",
      "side": 1,
      "message": "same here",
      "range": {
        "startLine": 2550,
        "startChar": 0,
        "endLine": 2551,
        "endChar": 43
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "278e684a_d968b02b",
        "filename": "src/tests/gl_tests/TextureTest.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2551,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-06-18T22:32:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6336f37f_773811aa",
      "range": {
        "startLine": 2550,
        "startChar": 0,
        "endLine": 2551,
        "endChar": 43
      },
      "revId": "e2694926d64f09c5c58d7e0d6906d554c7aa9147",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}