<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1287" height="1249" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[participant App
participant "ANGLE Front-end"
participant "Vulkan Back-end"
participant "ANGLE Translator"
participant "GlslangWrapperVk"
participant "Glslang"

App->"ANGLE Front-end": glCompileShader (VS)
"ANGLE Front-end"->"Vulkan Back-end": ShaderVk::compile
"Vulkan Back-end"->"ANGLE Translator": sh::Compile
"ANGLE Translator"->"ANGLE Front-end": return Vulkan-compatible GLSL

Note right of "ANGLE Front-end": Source is templated\nwith markers to be\nfilled at link time.

Note right of App: Same for FS, GS, etc...

App->"ANGLE Front-end": glCreateProgram (...)
App->"ANGLE Front-end": glAttachShader (...)
App->"ANGLE Front-end": glLinkProgram
"ANGLE Front-end"->"Vulkan Back-end": ProgramVk::link

Note right of "Vulkan Back-end": ProgramVk inits uniforms,\nlayouts, and descriptors.

"Vulkan Back-end"->GlslangWrapperVk: GlslangWrapperVk::GetShaderSpirvCode
GlslangWrapperVk->Glslang: GlslangToSpv
Glslang->GlslangWrapperVk: Return SPIR-V
GlslangWrapperVk->"Vulkan Back-end": return SPIR-V and specialization patches
"Vulkan Back-end"->"ANGLE Front-end": return success

Note right of App: App execution continues...

App->"ANGLE Front-end": glDrawArrays (any draw)
"ANGLE Front-end"->"Vulkan Back-end": ContextVk::drawArrays

Note right of "Vulkan Back-end": If specialization\nis necessary:

"Vulkan Back-end"->GlslangWrapperVk: GlslangWrapperVk::GetSpecializedShaderSpirvCode
GlslangWrapperVk->"Vulkan Back-end": Patched SPIR-V

Note right of "Vulkan Back-end": We init VkShaderModules\nand VkPipeline then\nrecord the draw.

"Vulkan Back-end"->"ANGLE Front-end": return success
]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="10" y="20" width="48.89999961853027" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">App</tspan></text></g><g class="actor"><rect x="10" y="1190.2000045776367" width="48.89999961853027" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="1215.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="20">App</tspan></text></g><line x1="34.44999980926514" x2="34.44999980926514" y1="59" y2="1190.2000045776367" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="252.66665935516357" y="20" width="164.5" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="262.6666593551636" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="262.6666593551636">ANGLE Front-end</tspan></text></g><g class="actor"><rect x="252.66665935516357" y="1190.2000045776367" width="164.5" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="262.6666593551636" y="1215.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="262.6666593551636">ANGLE Front-end</tspan></text></g><line x1="334.9166593551636" x2="334.9166593551636" y1="59" y2="1190.2000045776367" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="495.33333110809326" y="20" width="164.5" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="505.33333110809326" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="505.33333110809326">Vulkan Back-end</tspan></text></g><g class="actor"><rect x="495.33333110809326" y="1190.2000045776367" width="164.5" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="505.33333110809326" y="1215.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="505.33333110809326">Vulkan Back-end</tspan></text></g><line x1="577.5833311080933" x2="577.5833311080933" y1="59" y2="1190.2000045776367" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="781.3499937057495" y="20" width="174.13333129882812" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="791.3499937057495" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="791.3499937057495">ANGLE Translator</tspan></text></g><g class="actor"><rect x="781.3499937057495" y="1190.2000045776367" width="174.13333129882812" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="791.3499937057495" y="1215.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="791.3499937057495">ANGLE Translator</tspan></text></g><line x1="868.4166593551636" x2="868.4166593551636" y1="59" y2="1190.2000045776367" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="975.4833250045776" y="20" width="174.13333129882812" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="985.4833250045776" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="985.4833250045776">GlslangWrapperVk</tspan></text></g><g class="actor"><rect x="975.4833250045776" y="1190.2000045776367" width="174.13333129882812" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="985.4833250045776" y="1215.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="985.4833250045776">GlslangWrapperVk</tspan></text></g><line x1="1062.5499906539917" x2="1062.5499906539917" y1="59" y2="1190.2000045776367" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="1169.6166563034058" y="20" width="87.43333435058594" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1179.6166563034058" y="45" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1179.6166563034058">Glslang</tspan></text></g><g class="actor"><rect x="1169.6166563034058" y="1190.2000045776367" width="87.43333435058594" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="1179.6166563034058" y="1215.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1179.6166563034058">Glslang</tspan></text></g><line x1="1213.3333234786987" x2="1213.3333234786987" y1="59" y2="1190.2000045776367" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="signal"><text x="88.34999370574951" y="89.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="88.34999370574951">glCompileShader (VS)</tspan></text><line x1="34.44999980926514" x2="334.9166593551636" y1="98" y2="98" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="374.3666639328003" y="128.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="374.3666639328003">ShaderVk::compile</tspan></text><line x1="334.9166593551636" x2="577.5833311080933" y1="137" y2="137" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="670.0166616439819" y="167.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="670.0166616439819">sh::Compile</tspan></text><line x1="577.5833311080933" x2="868.4166593551636" y1="176" y2="176" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="461.98332500457764" y="206.5" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="461.98332500457764">return Vulkan-compatible GLSL</tspan></text><line x1="868.4166593551636" x2="334.9166593551636" y1="215" y2="215" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="354.9166593551636" y="235" width="202.6666717529297" height="67.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="359.9166593551636" y="255" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="359.9166593551636">Source is templated</tspan><tspan dy="1.2em" x="359.9166593551636">with markers to be</tspan><tspan dy="1.2em" x="359.9166593551636">filled at link time.</tspan></text></g><g class="note"><rect x="54.44999980926514" y="322.4000015258789" width="231.56666564941406" height="29" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="59.44999980926514" y="342.4000015258789" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="59.44999980926514">Same for FS, GS, etc...</tspan></text></g><g class="signal"><text x="83.53332805633545" y="381.9000015258789" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="83.53332805633545">glCreateProgram (...)</tspan></text><line x1="34.44999980926514" x2="334.9166593551636" y1="390.4000015258789" y2="390.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="88.34999370574951" y="420.9000015258789" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="88.34999370574951">glAttachShader (...)</tspan></text><line x1="34.44999980926514" x2="334.9166593551636" y1="429.4000015258789" y2="429.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="122.06666469573975" y="459.9000015258789" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="122.06666469573975">glLinkProgram</tspan></text><line x1="34.44999980926514" x2="334.9166593551636" y1="468.4000015258789" y2="468.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="383.9999952316284" y="498.9000015258789" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="383.9999952316284">ProgramVk::link</tspan></text><line x1="334.9166593551636" x2="577.5833311080933" y1="507.4000015258789" y2="507.4000015258789" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="597.5833311080933" y="527.4000015258789" width="250.8333282470703" height="48.20000076293945" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="602.5833311080933" y="547.4000015258789" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="602.5833311080933">ProgramVk inits uniforms,</tspan><tspan dy="1.2em" x="602.5833311080933">layouts, and descriptors.</tspan></text></g><g class="signal"><text x="646.6666669845581" y="606.1000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="646.6666669845581">GlslangWrapperVk::GetShaderSpirvCode</tspan></text><line x1="577.5833311080933" x2="1062.5499906539917" y1="614.6000022888184" y2="614.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1080.1416578292847" y="645.1000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1080.1416578292847">GlslangToSpv</tspan></text><line x1="1062.5499906539917" x2="1213.3333234786987" y1="653.6000022888184" y2="653.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="1075.3249921798706" y="684.1000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1075.3249921798706">Return SPIR-V</tspan></text><line x1="1213.3333234786987" x2="1062.5499906539917" y1="692.6000022888184" y2="692.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="627.3999891281128" y="723.1000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="627.3999891281128">return SPIR-V and specialization patches</tspan></text><line x1="1062.5499906539917" x2="577.5833311080933" y1="731.6000022888184" y2="731.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="388.8166608810425" y="762.1000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="388.8166608810425">return success</tspan></text><line x1="577.5833311080933" x2="334.9166593551636" y1="770.6000022888184" y2="770.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="54.44999980926514" y="790.6000022888184" width="260.46665954589844" height="29" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="59.44999980926514" y="810.6000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="59.44999980926514">App execution continues...</tspan></text></g><g class="signal"><text x="73.89999675750732" y="850.1000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="73.89999675750732">glDrawArrays (any draw)</tspan></text><line x1="34.44999980926514" x2="334.9166593551636" y1="858.6000022888184" y2="858.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="355.0999937057495" y="889.1000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="355.0999937057495">ContextVk::drawArrays</tspan></text><line x1="334.9166593551636" x2="577.5833311080933" y1="897.6000022888184" y2="897.6000022888184" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="597.5833311080933" y="917.6000022888184" width="173.76666259765625" height="48.20000076293945" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="602.5833311080933" y="937.6000022888184" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="602.5833311080933">If specialization</tspan><tspan dy="1.2em" x="602.5833311080933">is necessary:</tspan></text></g><g class="signal"><text x="593.6833295822144" y="996.3000030517578" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="593.6833295822144">GlslangWrapperVk::GetSpecializedShaderSpirvCode</tspan></text><line x1="577.5833311080933" x2="1062.5499906539917" y1="1004.8000030517578" y2="1004.8000030517578" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="752.6333265304565" y="1035.3000030517578" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="752.6333265304565">Patched SPIR-V</tspan></text><line x1="1062.5499906539917" x2="577.5833311080933" y1="1043.8000030517578" y2="1043.8000030517578" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="597.5833311080933" y="1063.8000030517578" width="231.56666564941406" height="67.4000015258789" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="602.5833311080933" y="1083.8000030517578" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="602.5833311080933">We init VkShaderModules</tspan><tspan dy="1.2em" x="602.5833311080933">and VkPipeline then</tspan><tspan dy="1.2em" x="602.5833311080933">record the draw.</tspan></text></g><g class="signal"><text x="388.8166608810425" y="1161.7000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="388.8166608810425">return success</tspan></text><line x1="577.5833311080933" x2="334.9166593551636" y1="1170.2000045776367" y2="1170.2000045776367" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>
