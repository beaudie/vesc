{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "526358c0_1bcae75d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1323689
      },
      "writtenOn": "2022-04-05T20:13:25Z",
      "side": 1,
      "message": "Updated commit message. I\u0027ll wait to see if Jonah has any feedback before hitting submit. Thanks for taking a look!",
      "revId": "9767e09db4eb7d4358f156053ab13a1c65fe151d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "45f09e9a_50eae6b7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 15
      },
      "lineNbr": 0,
      "author": {
        "id": 1326275
      },
      "writtenOn": "2022-04-05T20:56:47Z",
      "side": 1,
      "message": "LGTM, just one comment I\u0027m curious about",
      "revId": "9767e09db4eb7d4358f156053ab13a1c65fe151d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "258f3f44_75fbec4a",
        "filename": "src/libANGLE/renderer/gl/FramebufferGL.cpp",
        "patchSetId": 15
      },
      "lineNbr": 166,
      "author": {
        "id": 1326275
      },
      "writtenOn": "2022-04-05T20:56:47Z",
      "side": 1,
      "message": "nit: is there a specific reason for this upper bound or could you use mState.mColorAttachments.size() (or omit this upper bound altogether?)",
      "range": {
        "startLine": 166,
        "startChar": 17,
        "endLine": 166,
        "endChar": 57
      },
      "revId": "9767e09db4eb7d4358f156053ab13a1c65fe151d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "088b28c3_1ba581a4",
        "filename": "src/libANGLE/renderer/gl/FramebufferGL.cpp",
        "patchSetId": 15
      },
      "lineNbr": 166,
      "author": {
        "id": 1323689
      },
      "writtenOn": "2022-04-05T21:37:48Z",
      "side": 1,
      "message": "Hi Jonah, thanks for pointing out how to get the number of color attachments. The upper bound was added so that we\u0027re only calling framebufferTexture2D for color attachments although I realize I didn\u0027t grab a good upper bound to begin with. \n\nThat being said, do you know if we\u0027d need to worry about what attachments are valid in calls to framebufferTexture2D depending on the OpenGL/ES version we\u0027re using? Looking through the docs I see that in OpenGL es2.0 for example, the only valid attachments are GL_COLOR_ATTACHMENT0, GL_DEPTH_ATTACHMENT, or GL_STENCIL_ATTACHMENT. Looks like we could generate a GL_INVALID_ENUM error if we tried to unbind an invalid attachment. I\u0027m not sure what versions are currently supported though so I don\u0027t know if that\u0027s an issue.\n\nAdding onto this, I\u0027m not sure if the original driver error we\u0027re working around is generated on a DEPTH or STENCIL attachment, it\u0027s possible we want to unbind those as well. Vasily, do you think we\u0027d hit the error there? I can get a build together to check if needed.",
      "parentUuid": "258f3f44_75fbec4a",
      "range": {
        "startLine": 166,
        "startChar": 17,
        "endLine": 166,
        "endChar": 57
      },
      "revId": "9767e09db4eb7d4358f156053ab13a1c65fe151d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c640e6e7_f66afde4",
        "filename": "src/libANGLE/renderer/gl/FramebufferGL.cpp",
        "patchSetId": 15
      },
      "lineNbr": 166,
      "author": {
        "id": 1357502
      },
      "writtenOn": "2022-04-05T22:26:14Z",
      "side": 1,
      "message": "\u003e Hi Jonah, thanks for pointing out how to get the number of color attachments. The upper bound was added so that we\u0027re only calling framebufferTexture2D for color attachments although I realize I didn\u0027t grab a good upper bound to begin with. \n\u003e \n\u003e That being said, do you know if we\u0027d need to worry about what attachments are valid in calls to framebufferTexture2D depending on the OpenGL/ES version we\u0027re using? Looking through the docs I see that in OpenGL es2.0 for example, the only valid attachments are GL_COLOR_ATTACHMENT0, GL_DEPTH_ATTACHMENT, or GL_STENCIL_ATTACHMENT. Looks like we could generate a GL_INVALID_ENUM error if we tried to unbind an invalid attachment. I\u0027m not sure what versions are currently supported though so I don\u0027t know if that\u0027s an issue.\n\u003e \n\nRight after detachment we\u0027re going to attach a render buffer to the same attachment point. If it\u0027s invalid it will have the same issues. So I\u0027d assume it\u0027a always valid.\n\n\n\u003e Adding onto this, I\u0027m not sure if the original driver error we\u0027re working around is generated on a DEPTH or STENCIL attachment, it\u0027s possible we want to unbind those as well. Vasily, do you think we\u0027d hit the error there? I can get a build together to check if needed.\n\n\nI believe DEPTH and STENCIL can\u0027t have mipmaps, so the level should always be zero and we won\u0027t hit the bug.\n\nOriginally I had some concerns that it might not always be valid to call glFramebufferTexture2D with DEPTH/STENCIL attachments, so when some tests failed on your first attempt I suggested to add a check. But now looking at line 184 in this file, maybe we don\u0027t really need to check for attachment type here and in BlitGL.",
      "parentUuid": "088b28c3_1ba581a4",
      "range": {
        "startLine": 166,
        "startChar": 17,
        "endLine": 166,
        "endChar": 57
      },
      "revId": "9767e09db4eb7d4358f156053ab13a1c65fe151d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "79d51de9_8793abe0",
        "filename": "src/libANGLE/renderer/gl/FramebufferGL.cpp",
        "patchSetId": 15
      },
      "lineNbr": 166,
      "author": {
        "id": 1323689
      },
      "writtenOn": "2022-04-05T22:43:28Z",
      "side": 1,
      "message": "Ah good catch. I queued up a run to see if we can just always unbind the attachment. Assuming the run comes back green, does that seem safe here, Jonah?",
      "parentUuid": "c640e6e7_f66afde4",
      "range": {
        "startLine": 166,
        "startChar": 17,
        "endLine": 166,
        "endChar": 57
      },
      "revId": "9767e09db4eb7d4358f156053ab13a1c65fe151d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}