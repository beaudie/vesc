{
  "comments": [
    {
      "key": {
        "uuid": "a96e8d16_d0936c82",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-07-14T00:20:25Z",
      "side": 1,
      "message": "PTAL\n\nI think we\u0027re almost there.   This also has the updates to roll_aosp.sh to generate each of the configs.",
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b0645538_d8840bce",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1105284
      },
      "writtenOn": "2020-07-14T14:06:17Z",
      "side": 1,
      "message": "LGTM! Thanks for taking this, good to have you be familiar with this process too.",
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ec49be09_5ce9ec23",
        "filename": "scripts/generate_android_bp.py",
        "patchSetId": 6
      },
      "lineNbr": 386,
      "author": {
        "id": 1105284
      },
      "writtenOn": "2020-07-14T14:06:17Z",
      "side": 1,
      "message": "Any reason we can\u0027t have this as an input?",
      "range": {
        "startLine": 386,
        "startChar": 4,
        "endLine": 386,
        "endChar": 46
      },
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bed7a193_f58649fa",
        "filename": "scripts/generate_android_bp.py",
        "patchSetId": 6
      },
      "lineNbr": 386,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-07-14T16:09:05Z",
      "side": 1,
      "message": "Without blacklisting, we get this build rule:\n\n\tcc_genrule {\n\t    name: \"third_party_glslang_src_glslang_build_info\",\n\t    tool_files: [\n\t        \"third_party/glslang/src/build_info.py\",\n\t    ],\n\t    cmd: \"python $(location) external/angle/third_party/glslang/src -i external/angle/third_party/glslang/src/build_info.h.tmpl -o $(location glslang/build_info.h)\",\n\t    srcs: [\n\t        \"third_party/glslang/src/CHANGES.md\",\n\t        \"third_party/glslang/src/build_info.h.tmpl\",\n\t        \"third_party/glslang/src/build_info.py\",  \u003c\u003c--- no good\n\t    ],\n\t    sdk_version: \"28\",\n\t    out: [\n\t        \"glslang/build_info.h\",\n\t    ],\n\t}\n\nThat build rule generates this error:\n\n    out/soong/.bootstrap/bin/soong_build -t -l out/.module_paths/Android.bp.list -b out/soong -n out -d out/soong/build.ninja.d -globFile out/soong/.bootstrap/build-globs.ninja -o out/soong/build.ninja Android.bp\n    error: external/angle/Android.bp:1253:1: module \"third_party_glslang_src_glslang_build_info\" variant \"android_arm_armv7-a-neon\": multiple labels for \"third_party/glslang/src/build_info.py\", \"external/angle/third\n    _party/glslang/src/build_info.py\" and \"external/angle/third_party/glslang/src/build_info.py\"\n    09:42:23 soong bootstrap failed with: exit status 1\n\nIt doesn\u0027t seem to like having the tool and the source contain the same file.   No idea why, but we can work around it.\n\nIs there a better/earlier place to filter out matching filenames for cases like this from build_info[target]?",
      "parentUuid": "ec49be09_5ce9ec23",
      "range": {
        "startLine": 386,
        "startChar": 4,
        "endLine": 386,
        "endChar": 46
      },
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a196b87c_fa885932",
        "filename": "scripts/generate_android_bp.py",
        "patchSetId": 6
      },
      "lineNbr": 386,
      "author": {
        "id": 1105284
      },
      "writtenOn": "2020-07-15T15:14:56Z",
      "side": 1,
      "message": "I guess it\u0027s an artifact of the script being an input of the action in gn [0].\n\nHow about an explicit step to remove the script from the inputs?\n\n[0] https://source.chromium.org/chromium/chromium/src/+/master:third_party/glslang/src/BUILD.gn;l\u003d59?q\u003dbuild_info.py\u0026ss\u003dchromium%2Fchromium%2Fsrc",
      "parentUuid": "bed7a193_f58649fa",
      "range": {
        "startLine": 386,
        "startChar": 4,
        "endLine": 386,
        "endChar": 46
      },
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e98a5070_89516d58",
        "filename": "scripts/generate_android_bp.py",
        "patchSetId": 6
      },
      "lineNbr": 430,
      "author": {
        "id": 1105284
      },
      "writtenOn": "2020-07-14T14:06:17Z",
      "side": 1,
      "message": "Looks like this will be fixed upstream soon.  Up to you if you want to land first with the workaround.",
      "range": {
        "startLine": 428,
        "startChar": 0,
        "endLine": 430,
        "endChar": 31
      },
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "49f0cc68_b42af9c9",
        "filename": "scripts/generate_android_bp.py",
        "patchSetId": 6
      },
      "lineNbr": 430,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-07-14T16:09:05Z",
      "side": 1,
      "message": "I\u0027ll back this out.   It doesn\u0027t look like Ben\u0027s fix made the roll into ANGLE last night, so we\u0027ll just have to wait a day or two before trying to roll into AOSP, which is fine.",
      "parentUuid": "e98a5070_89516d58",
      "range": {
        "startLine": 428,
        "startChar": 0,
        "endLine": 430,
        "endChar": 31
      },
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b00a5c73_917fc1d5",
        "filename": "scripts/generate_android_bp.py",
        "patchSetId": 6
      },
      "lineNbr": 565,
      "author": {
        "id": 1105284
      },
      "writtenOn": "2020-07-14T14:06:17Z",
      "side": 1,
      "message": "Probably not necessary anymore.",
      "range": {
        "startLine": 564,
        "startChar": 0,
        "endLine": 565,
        "endChar": 80
      },
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5c4d4198_27ee926d",
        "filename": "scripts/generate_android_bp.py",
        "patchSetId": 6
      },
      "lineNbr": 565,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2020-07-14T16:09:05Z",
      "side": 1,
      "message": "Good catch. Done.",
      "parentUuid": "b00a5c73_917fc1d5",
      "range": {
        "startLine": 564,
        "startChar": 0,
        "endLine": 565,
        "endChar": 80
      },
      "revId": "7a9bc0626007491e32029bb9827159fcb777f88d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}