{
  "comments": [
    {
      "key": {
        "uuid": "1620e606_6012511d",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3415,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-05-21T14:42:39Z",
      "side": 1,
      "message": "Is this something we expect to change very often?\nIf not, this test seems a bit of a waste. Could we use a getter that returns the value we need?\nIt\u0027s probably minor perf-wise, what do people think?",
      "range": {
        "startLine": 3415,
        "startChar": 20,
        "endLine": 3415,
        "endChar": 69
      },
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d02d9f9_37b033e6",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3415,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-05-21T16:14:35Z",
      "side": 1,
      "message": "Yes.  For the \"default framebuffer\" (i.e. to a swapchain image), isViewportFlipEnabledForDrawFBO() will always return true.  It will always return false for FBOs and pbuffers.  As such, we need to query this.",
      "parentUuid": "1620e606_6012511d",
      "range": {
        "startLine": 3415,
        "startChar": 20,
        "endLine": 3415,
        "endChar": 69
      },
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "49429bec_803fce2c",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3415,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-05-21T16:44:37Z",
      "side": 1,
      "message": "What I\u0027m wondering is if we\u0027d save work moving this switch statement to where we set the state that affects isViewportFlipEnabledForDrawFBO() and save mFlipX and mFlipY which we can then use here without any testing.",
      "parentUuid": "6d02d9f9_37b033e6",
      "range": {
        "startLine": 3415,
        "startChar": 20,
        "endLine": 3415,
        "endChar": 69
      },
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "60d6d5b4_d73df37f",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3415,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-05-21T17:35:00Z",
      "side": 1,
      "message": "Possibly, but not much time.  I like your inquiry though, because I\u0027ve seen things that can save time in ANGLE, though I don\u0027t know that they would save enough to matter in a benchmark ...\n\nI\u0027ve watched some of the state-setting/dirty-bit-processing code a lot over the past few months.  Some of the functions that I\u0027ve watched get called multiple times for every call to this function (sometimes in the wrong order, and so they are called again).  I haven\u0027t logged calls to ContextVk::updateFlipViewportDrawFramebuffer() and ContextVk::onMakeCurrent(), but I have watched them in the debugger.  My sense is they aren\u0027t called repetitively; and that this isn\u0027t a huge place we spend time.  \n\nThe repetitive calls to lookup/calculate/set the scissor, rendering area, and viewport easily dwarf the time we spend on this.  I would like to look at that sometime, and probably need to to address the bug Charlie filed (b/151111296) about breaking a render pass with pre-rotation enabled.  Looks like it happens in the scissor-processing code when switching the draw framebuffer.\n\nBTW, I\u0027m suspicious of the \"viewport\" uniform value used above.  It could be very different from the one we calculate/set in ContextVk::updateViewport().",
      "parentUuid": "49429bec_803fce2c",
      "range": {
        "startLine": 3415,
        "startChar": 20,
        "endLine": 3415,
        "endChar": 69
      },
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6cf8b62c_3ae5c198",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3415,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-05-21T17:47:20Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "60d6d5b4_d73df37f",
      "range": {
        "startLine": 3415,
        "startChar": 20,
        "endLine": 3415,
        "endChar": 69
      },
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3b0f4471_dd00325f",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3419,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-05-21T14:42:39Z",
      "side": 1,
      "message": "flip only applies when no rotation?",
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d0ebe4c9_fbbd664e",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3419,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-05-21T16:14:35Z",
      "side": 1,
      "message": "All rotation cases are the \"default framebuffer\" (i.e. to a swapchain image).  As such, isViewportFlipEnabledForDrawFBO() will always return true.  Therefore, it\u0027s assumed as such for 90, 180, and 270-degree rotations.  The values of flipX and flipY are those that are needed in order to properly position the modified gl_FragCoord at the lower-left corner of the window (the GLES origin).",
      "parentUuid": "3b0f4471_dd00325f",
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "898f6ed7_a61419aa",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3419,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-05-21T16:44:37Z",
      "side": 1,
      "message": "Cool. A comment saying that rotation is baked in might be good.",
      "parentUuid": "d0ebe4c9_fbbd664e",
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2aab339c_7444c4b3",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3419,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-05-21T17:35:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "898f6ed7_a61419aa",
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5b884f7d_c8536937",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3419,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-05-22T06:38:53Z",
      "side": 1,
      "message": "Please ASSERT it. A possible future extension may allow the default framebuffer to have the same orientation as GLES for performance, for example.",
      "parentUuid": "2aab339c_7444c4b3",
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "00df4d2d_eaaa2f68",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3419,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-05-26T17:06:41Z",
      "side": 1,
      "message": "DONE",
      "parentUuid": "5b884f7d_c8536937",
      "revId": "0879735f1c2fa464588cbca6c37ba590dc503675",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}