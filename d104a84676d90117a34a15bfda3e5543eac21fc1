{
  "comments": [
    {
      "key": {
        "uuid": "19020b87_6247b935",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-08-31T22:22:19Z",
      "side": 1,
      "message": "I want to do some broader testing on this CL before starting the review.",
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0ff02f21_23ca9c6c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-08-31T23:54:30Z",
      "side": 1,
      "message": "Shabi, PTAL at how I \"moved\" mContentDefined for depth and stencil, but not for color.\n\nThis definitely fixes bugs (I enabled parts of tests from the previous CL that can now work correctly), and so I want to land this soon.",
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8735e37_468e4533",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-01T18:18:51Z",
      "side": 1,
      "message": "Please remove mKnowWhetherIsDepthStencil and just set mIsDepthStencil here based on `image`\u0027s format.",
      "range": {
        "startLine": 59,
        "startChar": 0,
        "endLine": 60,
        "endChar": 39
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b6314002_073ae983",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-09-01T19:05:08Z",
      "side": 1,
      "message": "That\u0027s what I initially did:\n\n  mIsDepthStencil \u003d mImage-\u003egetFormat().actualImageFormat().hasDepthOrStencilBits();\n\nIt actually crashes sometimes because mImage-\u003egetFormat() sometimes returns a reference to nullptr.  That\u0027s when I added mKnowWhetherIsDepthStencil.  Is there another alternative, because I\u0027d love to delete mKnowWhetherIsDepthStencil?",
      "parentUuid": "f8735e37_468e4533",
      "range": {
        "startLine": 59,
        "startChar": 0,
        "endLine": 60,
        "endChar": 39
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "75cd7d87_0eac5014",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-01T19:11:15Z",
      "side": 1,
      "message": "That\u0027s odd, could be good to figure out why that happens and fix that if possible.\n\nOtherwise, if that\u0027s in some corner cases, like swapchain render targets or something, you can probably pass that information to the init function instead.",
      "parentUuid": "b6314002_073ae983",
      "range": {
        "startLine": 59,
        "startChar": 0,
        "endLine": 60,
        "endChar": 39
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c10baf1_0d6a0f4c",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 60,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-09-01T19:45:52Z",
      "side": 1,
      "message": "I think it was a swapchain render target.  I\u0027ll look.",
      "parentUuid": "75cd7d87_0eac5014",
      "range": {
        "startLine": 59,
        "startChar": 0,
        "endLine": 60,
        "endChar": 39
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "46eadfa6_6f71f7e5",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 167,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-01T18:18:51Z",
      "side": 1,
      "message": "Depth",
      "range": {
        "startLine": 167,
        "startChar": 33,
        "endLine": 167,
        "endChar": 40
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8fae482_4d04ff36",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 167,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-09-01T19:05:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "46eadfa6_6f71f7e5",
      "range": {
        "startLine": 167,
        "startChar": 33,
        "endLine": 167,
        "endChar": 40
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a9150147_7935f146",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 167,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-01T19:11:15Z",
      "side": 1,
      "message": "Regression test would be nice!",
      "parentUuid": "46eadfa6_6f71f7e5",
      "range": {
        "startLine": 167,
        "startChar": 33,
        "endLine": 167,
        "endChar": 40
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "74821233_c18769c8",
        "filename": "src/libANGLE/renderer/vulkan/RenderTargetVk.cpp",
        "patchSetId": 2
      },
      "lineNbr": 167,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-09-01T19:45:52Z",
      "side": 1,
      "message": "My new tests used to vary the depth and stencil independently, but that got lost with some other requests ...",
      "parentUuid": "a9150147_7935f146",
      "range": {
        "startLine": 167,
        "startChar": 33,
        "endLine": 167,
        "endChar": 40
      },
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "358717bf_cb80f28b",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2869,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-01T18:18:51Z",
      "side": 1,
      "message": "Odd statement right next to mCurrentLayout \u003d Undefined!\n\nWouldn\u0027t something like this work instead?\n\n- Set to undefined here\n- When transitioning to a writable layout, conservatively set defined \u003d true.",
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "43a1ec55_dd2590aa",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2869,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-09-01T19:05:08Z",
      "side": 1,
      "message": "I changed it to false here, but some tests broke.  This does change ANGLE behavior (for the better I think, but I want both you and Charlie to be okay with it).\n\nCurrently, RenderTargetVk::mContentDefined is always initialized (\"conservatively\") to true, which results in a load op of LOAD for the first time the render target/image is used by a render pass.  That seems correct/optimal.  Therefore, I\u0027ll change the tests.  Seems like we should change it for color render target\u0027s as well.\n\nDo you agree?",
      "parentUuid": "358717bf_cb80f28b",
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "32512758_693641fb",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2869,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-09-01T19:11:15Z",
      "side": 1,
      "message": "That\u0027s something I\u0027ve been meaning to fix. Since this change doesn\u0027t touch color, let\u0027s just focus on depth/stencil for now.\n\nIf by \"change the tests\" you mean figure out why they break so we can see what\u0027s missing, that sounds good. I did mention setting this them to true when transitioning to a writable layout, but thinking again, RenderTargetVk::flushStagedUpdates should already correctly take care of this. If it doesn\u0027t, it\u0027s a bug that wouldn\u0027t just affect depth/stencil.",
      "parentUuid": "43a1ec55_dd2590aa",
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e8f9587_691561e6",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2869,
      "author": {
        "id": 1290487
      },
      "writtenOn": "2020-09-01T19:45:52Z",
      "side": 1,
      "message": "\u003e let\u0027s just focus on depth/stencil for now.\n\nSGTM\n\n\u003e If by \"change the tests\" you mean figure out why they break\n\nI wrote the tests, and they are looking at that initial load op.",
      "parentUuid": "32512758_693641fb",
      "revId": "d104a84676d90117a34a15bfda3e5543eac21fc1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}