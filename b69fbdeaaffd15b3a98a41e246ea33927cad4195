{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "392d771c_e7979bc4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1170419
      },
      "writtenOn": "2021-08-11T21:46:22Z",
      "side": 1,
      "message": "(lgtm fwiw) ",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "81057bee_0a9f4e34",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-11T21:58:04Z",
      "side": 1,
      "message": "I think something is still missing.\nChromium builders have \"query test results\" step, but ours don\u0027t, e.g.\nhttps://ci.chromium.org/ui/p/angle/builders/try/linux-clang-rel/23681/overview\n\nAlso there is no \"Test Results\" tab in MILO and https://ci.chromium.org/ui/p/angle/builders/try/linux-clang-rel/23681/test-results says:\nNo associated invocation.\nYou need to integrate with ResultDB to see the test results.\nSee go/resultdb or ask luci-eng@ for help.\n\nI wonder if this is because we don\u0027t actually upload yet?",
      "parentUuid": "392d771c_e7979bc4",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9de9a093_60708c6b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1170419
      },
      "writtenOn": "2021-08-11T22:03:52Z",
      "side": 1,
      "message": "That might in part be because infra/config/main.star changes only apply to builders after the change is submitted (and picked up by https://luci-config.appspot.com/). So tryjobs on CLs that make //infra/config changes aren\u0027t much use :/",
      "parentUuid": "81057bee_0a9f4e34",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5fa793cc_c504735e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-11T22:05:39Z",
      "side": 1,
      "message": "Oh. Is there a way I could test this with LED?\nOr just land and hope for the best?",
      "parentUuid": "9de9a093_60708c6b",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6f3e0c6b_5983c720",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-11T22:07:34Z",
      "side": 1,
      "message": "Both observations are because buildbucket/ResultDB integration has not been enabled.\n\nAfter this CL is submitted, you should be able see the step and \"Test Results\" tab on milo. But it may be empty because you don\u0027t actually upload results yet.",
      "parentUuid": "81057bee_0a9f4e34",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cb04b9f8_ccc0b478",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-11T22:16:51Z",
      "side": 1,
      "message": "I think for getting rid of the \"resultdb not enabled\" error, you only need the change on buildbucket cfg.",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "559dbcae_3dab8037",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-11T22:25:41Z",
      "side": 1,
      "message": "The eventual goal is to actually enable resultdb, so might as well do it sooner than later.",
      "parentUuid": "cb04b9f8_ccc0b478",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4174ddef_9651103f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-11T22:25:41Z",
      "side": 1,
      "message": "I got \"query test results\" step to appear via LED:\nhttps://luci-milo.appspot.com/raw/build/logs.chromium.org/angle/led/ynovikov_google.com/bbb411b5504571ff7985dd2c12b37c239d3c1defc9b0959edac5e04aa71e4795/+/annotations\n\nAlas, LED uses the old UI and not MILO, so there is no \"Test Results\" tab ðŸ˜ž",
      "parentUuid": "6f3e0c6b_5983c720",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b13a0dbf_1641e927",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-08-12T11:24:37Z",
      "side": 1,
      "message": "LGTM - one question for Chan.",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "82c92adb_26922246",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-12T17:24:02Z",
      "side": 1,
      "message": "I\u0027m going to land this as is, since now ANGLE CQ is broken because crrev.com/c/3087890 relanded.\nWe can figure the intricacies or result adapter later.",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8b8cb77f_8f021dc8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1170419
      },
      "writtenOn": "2021-08-12T17:42:57Z",
      "side": 1,
      "message": "Ah, whoops. I CQ+2 that CL having totally forgotten about this. My bad. Good news is that it\u0027s already been reverted :)",
      "parentUuid": "82c92adb_26922246",
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ffeeb2c3_4cac6d73",
        "filename": "infra/config/generated/cr-buildbucket.cfg",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-08-12T11:24:37Z",
      "side": 1,
      "message": "the formatting seems weird on these, not sure why.",
      "range": {
        "startLine": 27,
        "startChar": 0,
        "endLine": 27,
        "endChar": 8
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e063201b_526a06a9",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-11T22:16:51Z",
      "side": 1,
      "message": "Does angle run the same or a subset of test suites as chromium? If yes, does it run them the same way as chromium?",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb6216e6_2f2409f4",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-11T22:25:41Z",
      "side": 1,
      "message": "There is some overlap, like angle_unittests and angle_end2end_tests.\nI think there is actually no need to run these in Chromium, but it will take some time to get rid of the overlap.",
      "parentUuid": "e063201b_526a06a9",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b20b2ca0_8aa96975",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-11T22:44:45Z",
      "side": 1,
      "message": "Sorry what I really want to ask is: does ANGLE also use typ to run the tests? If yes then it makes sense to set \u0027has_native_resultdb_integration\u0027 to True. If no, what test runner(s) does ANGLE use and we need to confirm if they really integrate with resultdb natively.",
      "parentUuid": "cb6216e6_2f2409f4",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e295c530_40098e65",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-11T23:08:45Z",
      "side": 1,
      "message": "All the tests on these standalone bots use GTest.\nHowever, we wrap GTest in custom ANGLE harness, so they report their results in JSON format like isolated tests do.\nWe use \"use_isolated_scripts_api\": true in our build specs to get this scheme to work.",
      "parentUuid": "b20b2ca0_8aa96975",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c4cf9af4_f8c8c454",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-11T23:10:00Z",
      "side": 1,
      "message": "Example results:\nhttps://logs.chromium.org/logs/angle/buildbucket/cr-buildbucket.appspot.com/8839165753722967456/+/steps/angle_end2end_tests_on_Intel_GPU_on_Linux_on_Ubuntu-19.04/0/logs/json.output/0",
      "parentUuid": "e295c530_40098e65",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f3dd1baf_ad005af9",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-12T02:07:13Z",
      "side": 1,
      "message": "Interestingly, because that swarming task runs on chromium-swarm.appspot.com, ResultDB is already enabled for the swarming task [1]. \n\nBut because the test runner/script doesn\u0027t natively integrate with ResultDB, the test results were not uploaded to ResultDB [2].\n\nI found an angle_end2end_tests in chromium [3], and it\u0027s using a result_adapter to do the actual upload. [4]\n\nI think angle is using the same recipe as chromium? If so you don\u0027t need to make the changes on the pyl files and the recipe would know to use result_adapter automatically. Ben, is that right?\n\n[1]: https://screenshot.googleplex.com/4okcSZCb5AtLQUc\n[2]: https://screenshot.googleplex.com/E2d42YDcmRRozZA\n[3]: https://chromium-swarm.appspot.com/task?d\u003dtrue\u0026id\u003d55501a4b5d7c4010\n[4]: https://screenshot.googleplex.com/5yii7Nstj2Puzpd",
      "parentUuid": "c4cf9af4_f8c8c454",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5d4181b0_b710c92c",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-08-12T11:24:37Z",
      "side": 1,
      "message": "Hey Chan,\n\nWe use a different recipe that calls into the Chromium recipe modules (chromium_tests, test_utils, etc).\n\nSee here:\n\nhttps://source.chromium.org/chromium/chromium/tools/build/+/main:recipes/recipe_modules/angle/api.py;l\u003d107?q\u003dangle%2Fapi.py\u0026ss\u003dchromium\n\nDo you know what (if any) changes we need to make the ANGLE tests use the rdb adapter?",
      "parentUuid": "f3dd1baf_ad005af9",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a4dc7c86_01ebd932",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1170419
      },
      "writtenOn": "2021-08-12T18:17:16Z",
      "side": 1,
      "message": "Ah. If these tests aren\u0027t using typ and their test harness doesn\u0027t actually integrate with resultdb itself, then Chan\u0027s right that this has_native_resultdb_integration mixin in these testing specs is not needed (and is in fact preventing the results from being uploaded to rbd)\n\nresult-adapter (which wraps the test when has_native_resultdb_integration is false) reads the json itself and uploads the results. Though I don\u0027t know what format (gtest or json) it will end up using and which format it ends up needing.",
      "parentUuid": "5d4181b0_b710c92c",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2cadc068_57f28bc4",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-08-12T18:37:48Z",
      "side": 1,
      "message": "ANGLE outputs the \"chromium test results json format\". Presumably result-adapter can process this as the above link to angle_end2end_tests in the Chromium CQ will output the same format.\n\nBTW would there be some performance advantages to making the test harness itself communicate to ResultDB? Is there a C++ API for ResultDB or anything like that?",
      "parentUuid": "a4dc7c86_01ebd932",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b9ac84e2_5fbbdf4b",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-12T18:42:19Z",
      "side": 1,
      "message": "Since the logic of deciding whether to use result_adapter is in the chromium_tests recipe_module, I think it should just work for ANGLE the same way as chromium. Which means you only need to remove the changes in the pyl files, and the recipe can automatically know that the test suites should run with rdb and json result_adapter (the exact logic is at [1]).\n\n[1]: https://source.chromium.org/chromium/chromium/tools/build/+/main:recipes/recipe_modules/chromium_tests/generators.py;l\u003d537;drc\u003d4f18f03dedbad7aba2e03b8e2e00568fd627f28e",
      "parentUuid": "2cadc068_57f28bc4",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3cbfac1b_ea56934d",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-12T18:46:20Z",
      "side": 1,
      "message": "The differences between native integration and result_adapter are:\n1. native integration means the test runner can *stream* test results into ResultDB while running the tests; while result_adapter will upload all the test results after all the tests have run (because result_adapter reads the results from output.json).\n2. test harness owner will have full control on the test results uploaded to ResultDB, for example you could add your customized test results tags, and add test_locations to test_metadata, etc.",
      "parentUuid": "b9ac84e2_5fbbdf4b",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5019735e_0b500062",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1001921
      },
      "writtenOn": "2021-08-12T18:47:41Z",
      "side": 1,
      "message": "Thanks, I\u0027ll remove the .pyl changes, then.",
      "parentUuid": "b9ac84e2_5fbbdf4b",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4ce901d3_56217bf6",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-08-12T19:33:58Z",
      "side": 1,
      "message": "Thanks Chan. I was curious if performance was one of the goals of result_db. e.g. skipping the upload step at the end and doing continual streaming might be have higher throughput. Also asking again - is there a c++ API?",
      "parentUuid": "5019735e_0b500062",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8cc15bc0_070b7d67",
        "filename": "infra/specs/mixins.pyl",
        "patchSetId": 2
      },
      "lineNbr": 27,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2021-08-12T19:40:25Z",
      "side": 1,
      "message": "Yes performance is one of the goal.\n\nThere isn\u0027t a C++ API, but the test harness can make RPCs to the local ResultSink server to upload test results: please see go/result-sink for more details.\n\nAnd [1] is the code in typ to integrate with ResultSink. \n\n[1]: https://source.chromium.org/chromium/chromium/src/+/master:third_party/catapult/third_party/typ/typ/result_sink.py",
      "parentUuid": "5019735e_0b500062",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 27,
        "endChar": 95
      },
      "revId": "b69fbdeaaffd15b3a98a41e246ea33927cad4195",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}