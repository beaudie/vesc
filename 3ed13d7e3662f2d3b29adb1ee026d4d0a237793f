{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "02e76015_0477f208",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 433,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-09-24T14:31:16Z",
      "side": 1,
      "message": "I suspect you don\u0027t want to notify because the buffer is newly being set, but what if it\u0027s being re-set? Shouldn\u0027t you notify then?\n\nSomething like this:\n\n- glBufferData()\n- Use buffer as texture buffer\n- glDrawArrays()\n- glBufferData() // don\u0027t set any other state to avoid dirtying bits by accident\n- glDrawArrays()\n\nIt seems like with this DoNotNotify, the second draw arrays will not syncState(), because nothing is dirty, and that\u0027s not right. Same bug should manifest if VertexArray stops setting dirty bits on ContentsChanged like Texture is doing now.\n\nIn other words, shouldn\u0027t the notification be based on whether before the release() above there was previously a buffer allocated or not?",
      "range": {
        "startLine": 433,
        "startChar": 81,
        "endLine": 433,
        "endChar": 92
      },
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a603585_3739b606",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 433,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-09-24T15:06:24Z",
      "side": 1,
      "message": "I don\u0027t follow your example. If by \"use buffer as texture buffer\", you mean there\u0027s a glTextureBuffer call? That will definitely cause some state updates. I don\u0027t see any possible bug here.",
      "parentUuid": "02e76015_0477f208",
      "range": {
        "startLine": 433,
        "startChar": 81,
        "endLine": 433,
        "endChar": 92
      },
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85607a61_7860e217",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 433,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-09-24T19:42:17Z",
      "side": 1,
      "message": "\u003e you mean there\u0027s a glTextureBuffer call\n\nYes\n\n\u003e That will definitely cause some state updates. I don\u0027t see any possible bug here.\n\nIt would for the first draw call. The second draw call is the one that\u0027s not seeing any syncs.",
      "parentUuid": "7a603585_3739b606",
      "range": {
        "startLine": 433,
        "startChar": 81,
        "endLine": 433,
        "endChar": 92
      },
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4716f5ce_79400487",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 433,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-09-24T19:56:23Z",
      "side": 1,
      "message": "I don\u0027t think it\u0027s a problem. You get a call to TextureVk::setBuffer which can do everything it needs to do.\n\nCan we move forward with the CL as it stands? I\u0027m not opposed to you taking it over and writing more tests if you\u0027re worried about an edge case.",
      "parentUuid": "85607a61_7860e217",
      "range": {
        "startLine": 433,
        "startChar": 81,
        "endLine": 433,
        "endChar": 92
      },
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7f232b6_29635eb6",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 433,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-09-24T20:09:49Z",
      "side": 1,
      "message": "\u003e You get a call to TextureVk::setBuffer which can do everything it needs to do.\n\nAgain, that\u0027s at step 2 in my scenario. That\u0027s fine. I\u0027m talking about step 4, which doesn\u0027t make anything dirty, and step 5 which would then be using the old buffer.\n\n\u003e Can we move forward with the CL as it stands?\n\nSure, the bug is already present, since you are just giving the booleans a name. You might want to look out for this nevertheless, since you are working on this area. I\u0027ll make a note to come back to this if you don\u0027t happen to trigger this bug in another way as you continue your work.",
      "parentUuid": "4716f5ce_79400487",
      "range": {
        "startLine": 433,
        "startChar": 81,
        "endLine": 433,
        "endChar": 92
      },
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27552b8a_32fb5f05",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 976,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-09-24T14:31:16Z",
      "side": 1,
      "message": "Do you really need this? It looks to me like if `mBuffer \u003d\u003d nullptr` is the same as `notificationPolicy \u003d\u003d BufferNotificationPolicy::DoNotNotify`.\n\nIn other words, you don\u0027t notify if there is no buffer, and you do notify if there was a buffer that is now being changed (also see other comment)",
      "range": {
        "startLine": 976,
        "startChar": 69,
        "endLine": 976,
        "endChar": 87
      },
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "372780d8_b690c4c1",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.cpp",
        "patchSetId": 1
      },
      "lineNbr": 976,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-09-24T15:06:24Z",
      "side": 1,
      "message": "If we BufferData with the same size, we want to treat that as a SubData call. So yes this is necessary. This is for a future implementatino.",
      "parentUuid": "27552b8a_32fb5f05",
      "range": {
        "startLine": 976,
        "startChar": 69,
        "endLine": 976,
        "endChar": 87
      },
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0120086a_0ae5bca6",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.h",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2021-09-24T18:06:28Z",
      "side": 1,
      "message": "nit: This naming makes it sound like we only want to notify when the storage changes, which acquireBufferHelper() would check for.   Instead, the caller already knows the storage is changing which is why they are indicating the notification needs to be performed.\n\nThis would be better as just: Notify.",
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cf8fb0aa_2ad6c3b1",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.h",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-09-24T18:10:47Z",
      "side": 1,
      "message": "Your comment is only true for the acquire call itself. And if it\u0027s somewhat redundant there the extra verbosity makes sense in the context of all the other functions. LMK if this makes sense.",
      "parentUuid": "0120086a_0ae5bca6",
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ec625881_148950da",
        "filename": "src/libANGLE/renderer/vulkan/BufferVk.h",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1297197
      },
      "writtenOn": "2021-09-24T20:57:44Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "cf8fb0aa_2ad6c3b1",
      "revId": "3ed13d7e3662f2d3b29adb1ee026d4d0a237793f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}