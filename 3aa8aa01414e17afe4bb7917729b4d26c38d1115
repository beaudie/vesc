{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4949a04d_9daeab96",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 334,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "No need for `mLockBufferHelper` to be a pointer, and you can get rid of these allocations and frees. You could instead then do:\n\n    if (mLockBufferHelper.valid())\n        mLockBufferHelper.destroy(...);",
      "range": {
        "startLine": 330,
        "startChar": 0,
        "endLine": 334,
        "endChar": 5
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1ac5bf9c_f154c358",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 334,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4949a04d_9daeab96",
      "range": {
        "startLine": 330,
        "startChar": 0,
        "endLine": 334,
        "endChar": 5
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b6a82831_e6abbea1",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 453,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "Should this be something like `getHeight() * rowStride`? Probably `ImageHelper::CalculateBufferInfo` can be used to calculate `rowStride`.\n\nYou can try to have your tests use odd width/height sizes to make a potential issue here more prominent.",
      "range": {
        "startLine": 453,
        "startChar": 39,
        "endLine": 453,
        "endChar": 88
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9606f7bb_5782b8c2",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 453,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "CalculateBufferInfo required ContextVk, so I extracted from it down to a call to computeRowPitch, and scratched out the parameters needed.",
      "parentUuid": "b6a82831_e6abbea1",
      "range": {
        "startLine": 453,
        "startChar": 39,
        "endLine": 453,
        "endChar": 88
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b611a62c_c4e66557",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 470,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "You can surround this with `if (!mLockBufferHelper.valid()))` and remove the destroy() call from unlock. So the buffer is not recreated every frame.\n\nThe same with WindowSurfaceVk, except there should be a destroy when the swapchain is recreated too.\n\nYou would also not need to destroy() the buffer on every error below and can safely use ANGLE_TRY() like usual.",
      "range": {
        "startLine": 457,
        "startChar": 0,
        "endLine": 470,
        "endChar": 89
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "377d465f_bf823cd1",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 470,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b611a62c_c4e66557",
      "range": {
        "startLine": 457,
        "startChar": 0,
        "endLine": 470,
        "endChar": 89
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8190c6bd_674834fe",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 470,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-26T03:59:50Z",
      "side": 1,
      "message": "This is not done. The code is still recreating and destroying the buffer on every lock/unlock. It should only do so when the Surface size has changed.",
      "parentUuid": "377d465f_bf823cd1",
      "range": {
        "startLine": 457,
        "startChar": 0,
        "endLine": 470,
        "endChar": 89
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cccbd9e9_4ac6b501",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 470,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-26T15:34:28Z",
      "side": 1,
      "message": "I\u0027ll work on it.",
      "parentUuid": "8190c6bd_674834fe",
      "range": {
        "startLine": 457,
        "startChar": 0,
        "endLine": 470,
        "endChar": 89
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "11bee223_8e977b86",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 470,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-11-10T00:48:24Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cccbd9e9_4ac6b501",
      "range": {
        "startLine": 457,
        "startChar": 0,
        "endLine": 470,
        "endChar": 89
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1eb08372_84d9fd4c",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 476,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "Logically the map() should be done after the copy below.",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8ee8c29e_4b3d80df",
        "filename": "src/libANGLE/renderer/vulkan/SurfaceVk.cpp",
        "patchSetId": 3
      },
      "lineNbr": 476,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1eb08372_84d9fd4c",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9672aa62_592448f9",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3596,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "Instead, make `mapImpl` take a `Context` (that\u0027s `vk::Context`, but `vk::` is redundant here). It\u0027s not using any particular features of ContextVk.",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "43a5a77b_6542ee15",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3596,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9672aa62_592448f9",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c32d9396_023b8c68",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3685,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "Same with this, make `BufferHelper::init` take `Context` instead of `ContextVk`.",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "29064e99_7233a2cf",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3685,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c32d9396_023b8c68",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "60bca064_32e2695a",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 7138,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "nit: directly return instead",
      "range": {
        "startLine": 7138,
        "startChar": 5,
        "endLine": 7138,
        "endChar": 14
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b42cc3b5_859acf97",
        "filename": "src/libANGLE/renderer/vulkan/vk_helpers.cpp",
        "patchSetId": 3
      },
      "lineNbr": 7138,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "60bca064_32e2695a",
      "range": {
        "startLine": 7138,
        "startChar": 5,
        "endLine": 7138,
        "endChar": 14
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8309e3a_451c578f",
        "filename": "src/tests/egl_tests/EGLContextCompatibilityTest.cpp",
        "patchSetId": 3
      },
      "lineNbr": 478,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "Remember to uncomment before submission",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e6bf3a30_0b48ccda",
        "filename": "src/tests/egl_tests/EGLContextCompatibilityTest.cpp",
        "patchSetId": 3
      },
      "lineNbr": 478,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "b8309e3a_451c578f",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dcd39764_402e7a64",
        "filename": "src/tests/egl_tests/EGLLockSurface3Test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 101,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "Why skip?",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "046aa4e2_919c17b2",
        "filename": "src/tests/egl_tests/EGLLockSurface3Test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 101,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Temporary for testing, limit output noise. Gone.",
      "parentUuid": "dcd39764_402e7a64",
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c67fe4b9_daab77aa",
        "filename": "src/tests/egl_tests/EGLLockSurface3Test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 260,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "nit: feel free to just say `0, 1, 0, 1`, everyone knows that\u0027s green! Same with other tests below",
      "range": {
        "startLine": 260,
        "startChar": 17,
        "endLine": 260,
        "endChar": 87
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b11c4d64_3b7624d2",
        "filename": "src/tests/egl_tests/EGLLockSurface3Test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 260,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "OK, just being explicit, avoid magic numbers.",
      "parentUuid": "c67fe4b9_daab77aa",
      "range": {
        "startLine": 260,
        "startChar": 17,
        "endLine": 260,
        "endChar": 87
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7101eaa6_e86f74be",
        "filename": "src/tests/egl_tests/EGLLockSurface3Test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 363,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-10-02T02:22:02Z",
      "side": 1,
      "message": "typo: extra with",
      "range": {
        "startLine": 363,
        "startChar": 19,
        "endLine": 363,
        "endChar": 23
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6f311955_733d7a98",
        "filename": "src/tests/egl_tests/EGLLockSurface3Test.cpp",
        "patchSetId": 3
      },
      "lineNbr": 363,
      "author": {
        "id": 1359249
      },
      "writtenOn": "2021-10-13T23:52:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7101eaa6_e86f74be",
      "range": {
        "startLine": 363,
        "startChar": 19,
        "endLine": 363,
        "endChar": 23
      },
      "revId": "3aa8aa01414e17afe4bb7917729b4d26c38d1115",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}