{
  "comments": [
    {
      "key": {
        "uuid": "edc91f32_f704f2d0",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2427,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T15:25:51Z",
      "side": 1,
      "message": "Why do we have to end the render pass?\nI don\u0027t see anything in the spec about requiring that.\nhttps://www.khronos.org/registry/vulkan/specs/1.2-extensions/html/vkspec.html#debugging-debug-markers\nThe example shows inserting markers before each vkCmdDraw which would happen inside a renderpass.",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6294dc9b_a1bca04b",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2427,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-04-29T17:07:41Z",
      "side": 1,
      "message": "We don\u0027t have to end the renderPass. This change is simply moving the command from the primary to the SCB without any modification to the command ordering. Note that previously the commands were placed directly in the primary command buffer, and anything directly in the primary command buffer exists outside of the renderPass. Only commands in the renderPassCommandBuffer exist inside of the renderpass. When those commands are flushed to the primary, the renderPass is always ended so anything directly in the primary is either before or after a renderPass.\nThe old flushAndGetPrimaryCommandBuffer() function had the same effect of ending any active renderPass.\n\nYour point is taken, but the purpose of this CL is not to improve the treatment of debug utils commands in the cmd buffer, but just to get them off of the primary directly, which in this case means putting them into outsideRenderPassCommandBuffer.",
      "parentUuid": "edc91f32_f704f2d0",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2813b1ec_38311f07",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2427,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T17:57:15Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "6294dc9b_a1bca04b",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e16da03f_fe27fb7a",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2427,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-04-30T01:45:30Z",
      "side": 1,
      "message": "FYI, these functions used to close the RP in the command graph era because they needed to ensure no reordering is done around them, hence every node was made dependent to the node that recorded them. The behavior was maintained during the rework.",
      "parentUuid": "2813b1ec_38311f07",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1fa0cfe6_7ef2ca96",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2442,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T15:25:51Z",
      "side": 1,
      "message": "Likewise, don\u0027t think it\u0027s necessary to end a renderpass for this.",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "917f88d2_19a2e0c4",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2442,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-04-29T17:07:41Z",
      "side": 1,
      "message": "Same comment as above.",
      "parentUuid": "1fa0cfe6_7ef2ca96",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3dae156a_707ecd33",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2442,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T17:57:15Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "917f88d2_19a2e0c4",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "926250cf_36e62041",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2476,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T15:25:51Z",
      "side": 1,
      "message": "This doesn\u0027t seem right. Shouldn\u0027t it be beginDebugUtilsLabelEXT?",
      "range": {
        "startLine": 2476,
        "startChar": 36,
        "endLine": 2476,
        "endChar": 60
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aa498a7b_40d418d1",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2476,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-04-29T17:07:41Z",
      "side": 1,
      "message": "Why do you suspect that? Note that this change is just replicating the previous code. It\u0027s not attempting to change any functionality. This code as-is passes current debug label tests. If we want to change this functionality and add tests to verify that we should do that in a different CL.",
      "parentUuid": "926250cf_36e62041",
      "range": {
        "startLine": 2476,
        "startChar": 36,
        "endLine": 2476,
        "endChar": 60
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3e53e4cc_a505f412",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2476,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T17:57:15Z",
      "side": 1,
      "message": "I suspect this is a bug in the existing code.\npush is matched by pop. Corresponding VK commands should probably be beginDebugUtilsLabelEXT and endDebugUtilsLabelEXT.",
      "parentUuid": "aa498a7b_40d418d1",
      "range": {
        "startLine": 2476,
        "startChar": 36,
        "endLine": 2476,
        "endChar": 60
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cd9851ed_6c081394",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2476,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-04-30T01:45:30Z",
      "side": 1,
      "message": "Good catch. The Command Graph implementation had it right (https://chromium-review.googlesource.com/c/angle/angle/+/2055554/5/src/libANGLE/renderer/vulkan/CommandGraph.cpp#725), but there seems to be a copy-paste error during linearization (https://chromium-review.googlesource.com/c/angle/angle/+/2040197/14/src/libANGLE/renderer/vulkan/ContextVk.cpp#1247)\n\nTobin, would you mind fixing it please?",
      "parentUuid": "3e53e4cc_a505f412",
      "range": {
        "startLine": 2476,
        "startChar": 36,
        "endLine": 2476,
        "endChar": 60
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "95056d17_3457ce77",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2476,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-04-30T14:49:38Z",
      "side": 1,
      "message": "Shabi: if you look closely you\u0027ll see I copied the existing error 1:1 as a refactor.",
      "parentUuid": "cd9851ed_6c081394",
      "range": {
        "startLine": 2476,
        "startChar": 36,
        "endLine": 2476,
        "endChar": 60
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4db23497_902e684c",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2476,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2020-04-30T18:49:16Z",
      "side": 1,
      "message": "Jamie, if you look even more closely:\n\n        case CommandGraphNodeFunction::PushDebugMarker:\n            ...\n                primaryCommandBuffer-\u003ebeginDebugUtilsLabelEXT(label);\n\n(from the link https://chromium-review.googlesource.com/c/angle/angle/+/2055554/5/src/libANGLE/renderer/vulkan/CommandGraph.cpp#725)\n\nNot blaming or anything",
      "parentUuid": "95056d17_3457ce77",
      "range": {
        "startLine": 2476,
        "startChar": 36,
        "endLine": 2476,
        "endChar": 60
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dbc44e14_0aedd21c",
        "filename": "src/libANGLE/renderer/vulkan/ContextVk.cpp",
        "patchSetId": 20
      },
      "lineNbr": 2476,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2020-04-30T19:08:39Z",
      "side": 1,
      "message": "Right. The original code didn\u0027t call that.",
      "parentUuid": "4db23497_902e684c",
      "range": {
        "startLine": 2476,
        "startChar": 36,
        "endLine": 2476,
        "endChar": 60
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "acef0eb2_362daa23",
        "filename": "src/libANGLE/renderer/vulkan/SecondaryCommandBuffer.h",
        "patchSetId": 20
      },
      "lineNbr": 733,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T15:25:51Z",
      "side": 1,
      "message": "FYI - we do have some utility functions to do this: src/common/mathutil.h\nroundUp. e.g. const size_t alignedSize \u003d roundUp\u003csize_t\u003e(requiredSize, 4);",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "92dc1bc6_3297cc2a",
        "filename": "src/libANGLE/renderer/vulkan/SecondaryCommandBuffer.h",
        "patchSetId": 20
      },
      "lineNbr": 733,
      "author": {
        "id": 1256245
      },
      "writtenOn": "2020-04-29T17:07:41Z",
      "side": 1,
      "message": "Sweet, thanks!",
      "parentUuid": "acef0eb2_362daa23",
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "58cf0184_09c20bc6",
        "filename": "src/libANGLE/renderer/vulkan/SecondaryCommandBuffer.h",
        "patchSetId": 20
      },
      "lineNbr": 795,
      "author": {
        "id": 1263724
      },
      "writtenOn": "2020-04-29T15:25:51Z",
      "side": 1,
      "message": "roundUp\u003csize_t\u003e(stringSize, 4)",
      "range": {
        "startLine": 795,
        "startChar": 37,
        "endLine": 795,
        "endChar": 74
      },
      "revId": "1ab7e512804f3021594e8779a3289f456b025f0f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}