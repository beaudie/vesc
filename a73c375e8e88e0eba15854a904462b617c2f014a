{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "abac0658_78f3f6f4",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2023-03-30T13:37:52Z",
      "side": 1,
      "message": "`glFenceSync` causes a flush, so it should ideally be banned",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ea1afc1b_35af7aa2",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1543967
      },
      "writtenOn": "2023-03-30T15:44:24Z",
      "side": 1,
      "message": "Does it cause a flush in the Vulkan backend or something? It would be really bad for performance if inserting a sync into the command stream caused a flush.\n\nI don\u0027t see any mention of a flush in https://docs.gl/es3/glFenceSync, and https://registry.khronos.org/OpenGL/extensions/EXT/EXT_shader_pixel_local_storage.txt also only calls out `glClientWaitSync`, not `glFenceSync`.",
      "parentUuid": "abac0658_78f3f6f4",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a56a5a35_597e52fd",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2023-03-30T15:48:26Z",
      "side": 1,
      "message": "Right, not so much a flush as breaking the render pass (which is what matters here).\n\nThe insertion of the fence doesn\u0027t incur a flush, but another thread could issue a fence wait and cause the flush anyway, so inserting a fence in the middle of a render pass cannot just defer signalling it until the natural end of render pass.",
      "parentUuid": "ea1afc1b_35af7aa2",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "caeb336a_2e128a95",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2023-03-30T21:29:52Z",
      "side": 1,
      "message": "Is Chrome really calling glFenceSync in the middle of the user\u0027s WebGL command stream that uses PLS? I would think that shouldn\u0027t happen. If the browser\u0027s using sync objects internally then it should interrupt and restore PLS around those calls, and hopefully that would be a rare event.",
      "parentUuid": "a56a5a35_597e52fd",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e061b79_9917d16f",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1543967
      },
      "writtenOn": "2023-03-31T01:06:54Z",
      "side": 1,
      "message": "Good call Ken. It looks like it was coming down through a blink callstack invoking `glDescheduleUntilFinishedCHROMIUM`, and I already covered it with an interrupt on the blink side.\n\nRe-banning `glFenceSync`.",
      "parentUuid": "caeb336a_2e128a95",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b0904ab7_afdc6d91",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2023-03-31T01:09:00Z",
      "side": 1,
      "message": "Great, thanks. CL description needs to be updated to match.",
      "parentUuid": "7e061b79_9917d16f",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "30489c55_60923a22",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1543967
      },
      "writtenOn": "2023-03-31T01:09:20Z",
      "side": 1,
      "message": "I should also point out that this only happens when the JS app is buggy and leaves pixel local storage enabled for compositing",
      "parentUuid": "7e061b79_9917d16f",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aaa5f28d_8c39dbea",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 440,
      "author": {
        "id": 1543967
      },
      "writtenOn": "2023-03-31T01:30:49Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "30489c55_60923a22",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6860b84e_23bfcbcc",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 490,
      "author": {
        "id": 1394635
      },
      "writtenOn": "2023-03-30T09:41:11Z",
      "side": 1,
      "message": "Please clarify that this error is generated only when `target` is `BLEND`.",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5412719_d14f2ec9",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 490,
      "author": {
        "id": 1543967
      },
      "writtenOn": "2023-03-30T15:44:24Z",
      "side": 1,
      "message": "Since we are creating an explicit \"allow\" list here, I think the correct approach would be to ban everything that isn\u0027t `BLEND`.\n\nEither way though, I think the result would be the same since `BLEND` is the only indexed capability in all of ES and all ES extensions that I\u0027m aware of.",
      "parentUuid": "6860b84e_23bfcbcc",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d1125e4_06c5607f",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 490,
      "author": {
        "id": 1394635
      },
      "writtenOn": "2023-03-30T16:46:22Z",
      "side": 1,
      "message": "There are three unimplemented indexed caps:\n- `SCISSOR_TEST_EXCLUSIVE_NV` from `NV_scissor_exclusive`\n- `SCISSOR_TEST` from `NV_viewport_array` and `OES_viewport_array`\n- `SHADING_RATE_IMAGE_NV` from `NV_shading_rate_image`\n\nFirst two seem compatible with PLS, not sure about the third.",
      "parentUuid": "a5412719_d14f2ec9",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b29903fc_26c763cf",
        "filename": "extensions/ANGLE_shader_pixel_local_storage.txt",
        "patchSetId": 3
      },
      "lineNbr": 490,
      "author": {
        "id": 1543967
      },
      "writtenOn": "2023-03-31T01:06:54Z",
      "side": 1,
      "message": "Thanks for pointing these out. Added the first two.\n\nShading rate is not compatible with PLS unless we emulate it in the shader image implementation. It sounds potentially interesting, but also costly and like it might defeat the purpose of the shading rate extension in the first place. I\u0027d rather not include it in this extension.",
      "parentUuid": "3d1125e4_06c5607f",
      "revId": "a73c375e8e88e0eba15854a904462b617c2f014a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}