{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "64b8a8cc_1f06b7a9",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T19:38:38Z",
      "side": 1,
      "message": "Initial implementation for backend enqueue calls is performed under a queue lock\n```suggestion\n    std::scoped_lock\u003cstd::mutex\u003e sl(mCommandQueueMutex);\n    CLImageVk \u0026imageVk \u003d image.getImpl\u003cCLImageVk\u003e();\n```",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "627b0da8_3dce376f",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-08-30T19:54:12Z",
      "side": 1,
      "message": "nit: Please use `angle::SimpleMutex`",
      "parentUuid": "64b8a8cc_1f06b7a9",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7dfbd964_dffdc625",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-08-30T19:56:16Z",
      "side": 1,
      "message": "Sorry looks like `mCommandQueueMutex` is already `std::mutex`. Feel free to move to `angle::SimpleMutex` for less overhead if these are just binary mutexes that do nothing but lock/unlock.\n\n(not in this CL, whenever you feel like)",
      "parentUuid": "627b0da8_3dce376f",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7f9d4a31_193db903",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T19:59:26Z",
      "side": 1,
      "message": "@syoussefi@chromium.org - Sure, but I think this can be a follow-up task, since we already implemented CLCommandQueueVk\u0027s mutex using STL (change here would be a bit out-of-scope).\n\nCan we make this a follow-up task? I\u0027ll go ahead and create a Bug-ticket for it.",
      "parentUuid": "627b0da8_3dce376f",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b7cd915_23f2d15d",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2024-08-30T20:05:13Z",
      "side": 1,
      "message": "(race condition, already replied)",
      "parentUuid": "7f9d4a31_193db903",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d12960db_69480407",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T20:33:52Z",
      "side": 1,
      "message": "Dang, I must have grabbed the wrong Gerrit lock then... ðŸ˜‚\n\nCool sounds good - created the bugticket as well: \nhttps://issues.angleproject.org/issues/363243412",
      "parentUuid": "8b7cd915_23f2d15d",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "df579d1d_4d082ab7",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-05T09:52:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d12960db_69480407",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9346dc58_ba838863",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-07T06:53:03Z",
      "side": 1,
      "message": "@Austin I ended up reverting this change since it was causing tests such as test_basic imagecopy, test_basic imagearraycopy, test_basic imagerandomcopy, and test_basic arrayimagecopy to hang.",
      "parentUuid": "df579d1d_4d082ab7",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "afb3b364_3ed787b5",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 362,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-10-07T17:42:06Z",
      "side": 1,
      "message": "Please keep the top-level locking. The hang issue is likely due to a few lines below where we call\n```\nANGLE_TRY(finish());\n```\nin the blocking case where we try to grab the lock twice. Can you try using `finishInternal()` instead, as that does not grab the queue lock here.",
      "parentUuid": "9346dc58_ba838863",
      "range": {
        "startLine": 362,
        "startChar": 4,
        "endLine": 362,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "22d46159_578d871b",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 424,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T19:38:38Z",
      "side": 1,
      "message": "```suggestion\n    std::scoped_lock\u003cstd::mutex\u003e sl(mCommandQueueMutex);\n    ANGLE_TRY(enqueueWaitForEvents(waitEvents));\n```",
      "range": {
        "startLine": 424,
        "startChar": 4,
        "endLine": 424,
        "endChar": 48
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "663091cd_4ea3b97e",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 424,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-05T09:52:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "22d46159_578d871b",
      "range": {
        "startLine": 424,
        "startChar": 4,
        "endLine": 424,
        "endChar": 48
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4b80dd51_a6c5075b",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 424,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-07T06:53:03Z",
      "side": 1,
      "message": "@Austin Change was reverted. Please see other comment.",
      "parentUuid": "663091cd_4ea3b97e",
      "range": {
        "startLine": 424,
        "startChar": 4,
        "endLine": 424,
        "endChar": 48
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "12adc18c_2814c63a",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 454,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T19:38:38Z",
      "side": 1,
      "message": "```suggestion\n    std::scoped_lock\u003cstd::mutex\u003e sl(mCommandQueueMutex);\n    ANGLE_TRY(enqueueWaitForEvents(waitEvents));\n```",
      "range": {
        "startLine": 454,
        "startChar": 4,
        "endLine": 454,
        "endChar": 48
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d67a82bc_b89c1a3f",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 454,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-05T09:52:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "12adc18c_2814c63a",
      "range": {
        "startLine": 454,
        "startChar": 4,
        "endLine": 454,
        "endChar": 48
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1cb010a2_3c1f8d63",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 454,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-07T06:53:03Z",
      "side": 1,
      "message": "@Austin Change was reverted. Please see other comment.",
      "parentUuid": "d67a82bc_b89c1a3f",
      "range": {
        "startLine": 454,
        "startChar": 4,
        "endLine": 454,
        "endChar": 48
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0e8879f1_2aa4f698",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 520,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T19:38:38Z",
      "side": 1,
      "message": "```suggestion\n    std::scoped_lock\u003cstd::mutex\u003e sl(mCommandQueueMutex);\n    CLImageVk \u0026srcImageVk   \u003d srcImage.getImpl\u003cCLImageVk\u003e();\n```",
      "range": {
        "startLine": 520,
        "startChar": 4,
        "endLine": 520,
        "endChar": 60
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "23fd9788_a068df78",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 520,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-05T09:52:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0e8879f1_2aa4f698",
      "range": {
        "startLine": 520,
        "startChar": 4,
        "endLine": 520,
        "endChar": 60
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "26773f58_18c7cc68",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 520,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-07T06:53:03Z",
      "side": 1,
      "message": "@Austin Change was reverted. Please see other comment.",
      "parentUuid": "23fd9788_a068df78",
      "range": {
        "startLine": 520,
        "startChar": 4,
        "endLine": 520,
        "endChar": 60
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ceecb86_80c07e01",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 541,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T19:38:38Z",
      "side": 1,
      "message": "```suggestion\n    std::scoped_lock\u003cstd::mutex\u003e sl(mCommandQueueMutex);\n    CLBufferVk \u0026srcBufferVk \u003d srcBuffer.getImpl\u003cCLBufferVk\u003e();\n```",
      "range": {
        "startLine": 541,
        "startChar": 4,
        "endLine": 541,
        "endChar": 62
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "25d59c57_edf54dab",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 541,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-05T09:52:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ceecb86_80c07e01",
      "range": {
        "startLine": 541,
        "startChar": 4,
        "endLine": 541,
        "endChar": 62
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f288192c_ed7ed07a",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 541,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-07T06:53:03Z",
      "side": 1,
      "message": "@Austin Change was reverted. Please see other comment.",
      "parentUuid": "25d59c57_edf54dab",
      "range": {
        "startLine": 541,
        "startChar": 4,
        "endLine": 541,
        "endChar": 62
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c6e216c7_8d7d0ba0",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 565,
      "author": {
        "id": 1604617
      },
      "writtenOn": "2024-08-30T19:38:38Z",
      "side": 1,
      "message": "```suggestion\n    std::scoped_lock\u003cstd::mutex\u003e sl(mCommandQueueMutex);\n    CLImageVk \u0026imageVk \u003d image.getImpl\u003cCLImageVk\u003e();\n```",
      "range": {
        "startLine": 565,
        "startChar": 4,
        "endLine": 565,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "75ce2f16_e1c82984",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 565,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-05T09:52:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c6e216c7_8d7d0ba0",
      "range": {
        "startLine": 565,
        "startChar": 4,
        "endLine": 565,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5f84f6d7_c7188f42",
        "filename": "src/libANGLE/renderer/vulkan/CLCommandQueueVk.cpp",
        "patchSetId": 10
      },
      "lineNbr": 565,
      "author": {
        "id": 3319458
      },
      "writtenOn": "2024-10-07T06:53:03Z",
      "side": 1,
      "message": "@Austin Change was reverted. Please see other comment.",
      "parentUuid": "75ce2f16_e1c82984",
      "range": {
        "startLine": 565,
        "startChar": 4,
        "endLine": 565,
        "endChar": 52
      },
      "revId": "20e88fce52506767b51d95e10042f94e1ed7b0e3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}