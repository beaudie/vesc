{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "1ca31dfc_36d5bb50",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-05-03T16:35:58Z",
      "side": 1,
      "message": "What\u0027s the real motivation for this change? Chromium on Fuchsia runs already. Was Fuchsia faking support for VK_KHR_swapchain and plans to no longer do it?\n\nIs it possible for Fuchsia to implement VK_EXT_headless_surface, and then we can use DisplayVkHeadless?",
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "789ffac2_46c69e59",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2021-05-05T06:50:49Z",
      "side": 1,
      "message": "We do have swapchain on Fuchsia (used in DisplayVkFuchsia), but it\u0027s not being used when running chromium on Fuchsia. We use ImagePipe directly (see https://source.chromium.org/chromium/chromium/src/+/main:components/viz/service/display_embedder/output_presenter_fuchsia.h ).\nCurrently ANGLE depends on swapchain layer. This means that we have to package VkLayer_image_pipe_swapchain.so in web_engine.far. This increases package size (by more than 400kB) and wastes resources in runtime, which is not ideal when running on devices with limited resources (note that in most cases the version that gets packaged in chromium is not the same as the one used in other packages, so it doesn\u0027t get deduped in storage)\n\nWe currently don\u0027t have VK_EXT_headless_surface implementation on Fuchsia. If we had it, it would require packaging a separate .so file. It would probably be a bit smaller than VkLayer_image_pipe_swapchain.so, but this doesn\u0027t look like the best solution. What I\u0027m trying to achieve with this CL is to make ANGLE usable without the Surface/Swapchain extensions.",
      "parentUuid": "1ca31dfc_36d5bb50",
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "67dd698a_53c15cea",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1329751
      },
      "writtenOn": "2021-05-05T13:37:45Z",
      "side": 1,
      "message": "Do you have any links to info as to why vulkan exts are implemented as separate sos? That seems unusual vs any other Vulkan driver I\u0027ve seen.",
      "parentUuid": "789ffac2_46c69e59",
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6558587d_d78ad90e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-05-05T13:45:32Z",
      "side": 1,
      "message": "Ok. I never really understood why Fuchsia is implementing the swapchain with a layer. Out of scope of this change, but perhaps VkLayer_image_pipe_swapchain could be replaced entirely by VK_EXT_headless_surface in Fuchsia, or if that extension is not sufficient, a new extension proposed. With this change, there are three \"headless\" displays in the Vulkan backend!",
      "parentUuid": "789ffac2_46c69e59",
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5d1e6d37_caefa736",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2021-05-05T18:48:08Z",
      "side": 1,
      "message": "VkLayer_image_pipe_swapchain implements VK_FUCHSIA_imagepipe_surface extension. It\u0027s a useful extension for clients that need to use swapchain on Fuchsia. It\u0027s not headless and it can\u0027t be replaced with VK_EXT_headless_surface. Problem with swapchain is that it doesn\u0027t provide accurate presentation timestamps. So we use ImagePipe directly to improve A/V sync. Swapchain with VK_FUCHSIA_imagepipe_surface is still usable for applications that don\u0027t need precise A/V sync.\n\nDisplayVkHeadless was added to avoid X11 dependency in Chrome on Linux, see crbug.com/1034840 . \nAccording to comments on that bug, Chrome doesn\u0027t use swapchain on Linux either, similar to what we have on Fuchsia. So I think in that case DisplayVkNull can be used instead of DisplayVkHeadless (I\u0027m not sure if there are other use-cases for DisplayVkHeadless).",
      "parentUuid": "6558587d_d78ad90e",
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a74bec40_b241c717",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-05-05T18:59:09Z",
      "side": 1,
      "message": "Ack, thanks for the explanation.",
      "parentUuid": "5d1e6d37_caefa736",
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6ddc7226_673bea8f",
        "filename": "gni/angle.gni",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1300114
      },
      "writtenOn": "2021-05-03T16:35:58Z",
      "side": 1,
      "message": "typo",
      "range": {
        "startLine": 132,
        "startChar": 33,
        "endLine": 132,
        "endChar": 35
      },
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0f358cfa_b79d223f",
        "filename": "gni/angle.gni",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2021-05-05T06:50:49Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6ddc7226_673bea8f",
      "range": {
        "startLine": 132,
        "startChar": 33,
        "endLine": 132,
        "endChar": 35
      },
      "revId": "f2397b933033376170fa54245d878747cc4c11ef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}